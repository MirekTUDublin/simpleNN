<!DOCTYPE html>
<!-- saved from url=(0184)https://web.archive.org/web/20210423082804/https://www.samsonzhang.com/2020/11/24/understanding-the-math-behind-neural-networks-by-building-one-from-scratch-no-tf-keras-just-numpy.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script type="text/javascript" async="" src="./Understanding_files/analytics.js"></script><script src="./Understanding_files/analytics(1).js" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app224.us.archive.org';v.server_ms=2042;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="./Understanding_files/bundle-playback.js" charset="utf-8"></script>
<script type="text/javascript" src="./Understanding_files/wombat.js" charset="utf-8"></script>
<script type="text/javascript">
  __wm.init("https://web.archive.org/web");
  __wm.wombat("https://www.samsonzhang.com/2020/11/24/understanding-the-math-behind-neural-networks-by-building-one-from-scratch-no-tf-keras-just-numpy.html","20210423082804","https://web.archive.org/","web","/_static/",
	      "1619166484");
</script>
<link rel="stylesheet" type="text/css" href="./Understanding_files/banner-styles.css">
<link rel="stylesheet" type="text/css" href="./Understanding_files/iconochive.css">
<!-- End Wayback Rewrite JS Include -->

        <meta content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, target-densityDpi=device-dpi" name="viewport">
        <title>
        
        
        Understanding the math behind neural networks by building one from scratch (no TF/Keras, just numpy)
        
         |
        
        Samson Zhang
        </title>
        <link href="./Understanding_files/css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="./Understanding_files/style.css">
        <link rel="stylesheet" type="text/css" href="./Understanding_files/all.min.css">
        <link rel="stylesheet" type="text/css" href="./Understanding_files/monokai.css">

        <!-- favicon code from realfavicongenerator.net -->

        <link rel="apple-touch-icon" sizes="180x180" href="https://web.archive.org/web/20210423082804im_/https://www.samsonzhang.com/favicon/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="https://web.archive.org/web/20210423082804im_/https://www.samsonzhang.com/favicon/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="https://web.archive.org/web/20210423082804im_/https://www.samsonzhang.com/favicon/favicon-16x16.png">
        <link rel="manifest" href="https://web.archive.org/web/20210423082804/https://www.samsonzhang.com/site.webmanifest">
        <link rel="mask-icon" href="https://web.archive.org/web/20210423082804im_/https://www.samsonzhang.com/favicon/safari-pinned-tab.svg" color="#5bbad5">
        <meta name="msapplication-TileColor" content="#2b5797">
        <meta name="theme-color" content="#ffffff">
        
        <script src="./Understanding_files/jquery-3.4.1.min.js"></script>
        <script src="./Understanding_files/masonry.pkgd.min.js"></script>
        <script src="./Understanding_files/imagesloaded.pkgd.min.js"></script>
        <script src="./Understanding_files/d3.v5.min.js"></script>
        <script src="./Understanding_files/d3-bboxCollide.min.js"></script>
        <script type="text/javascript" async="" src="./Understanding_files/MathJax.js">
            </script>

        <!-- Twitter cards -->
        <meta name="twitter:site" content="@wwsalmon">
        <meta name="twitter:creator" content="@wwsalmon">
        <meta name="twitter:title" content="Understanding the math behind neural networks by building one from scratch (no TF/Keras, just numpy)">
        
        
        <meta name="twitter:description" content="

Anybody with even a passing interest in AI/ML likely knows the basics about neural networks. You connect a couple of layers of nodes with weights and biases, train it on some data, and bam, you’v...">
        
        
        <meta name="twitter:card" content="summary_large_image">
        
        
        <!-- end of Twitter cards -->
    <style data-styled="active" data-styled-version="5.3.6">.heKozI{visibility:hidden;}.kYxvte{font-family:roboto;font-weight:100;}.kYxvtg{font-family:roboto;font-weight:300;}.kYxvtj{font-family:roboto;font-weight:400;}.kYxvti{font-family:roboto;font-weight:500;}.kYxvtk{font-family:roboto;font-weight:700;}.kYxvtm{font-family:roboto;font-weight:900;}.iRXaCE{font-family:rebond;font-weight:400;}.iRXaCF{font-family:rebond;font-weight:500;}.iRXaCC{font-family:rebond;font-weight:600;}.iRXaCD{font-family:rebond;font-weight:700;}</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.mjx-chtml {display: inline-block; line-height: 0; text-indent: 0; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; letter-spacing: normal; word-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; margin: 0; padding: 1px 0}
.MJXc-display {display: block; text-align: center; margin: 1em 0; padding: 0}
.mjx-chtml[tabindex]:focus, body :focus .mjx-chtml[tabindex] {display: inline-table}
.mjx-full-width {text-align: center; display: table-cell!important; width: 10000em}
.mjx-math {display: inline-block; border-collapse: separate; border-spacing: 0}
.mjx-math * {display: inline-block; -webkit-box-sizing: content-box!important; -moz-box-sizing: content-box!important; box-sizing: content-box!important; text-align: left}
.mjx-numerator {display: block; text-align: center}
.mjx-denominator {display: block; text-align: center}
.MJXc-stacked {height: 0; position: relative}
.MJXc-stacked > * {position: absolute}
.MJXc-bevelled > * {display: inline-block}
.mjx-stack {display: inline-block}
.mjx-op {display: block}
.mjx-under {display: table-cell}
.mjx-over {display: block}
.mjx-over > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-under > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-stack > .mjx-sup {display: block}
.mjx-stack > .mjx-sub {display: block}
.mjx-prestack > .mjx-presup {display: block}
.mjx-prestack > .mjx-presub {display: block}
.mjx-delim-h > .mjx-char {display: inline-block}
.mjx-surd {vertical-align: top}
.mjx-mphantom * {visibility: hidden}
.mjx-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 2px 3px; font-style: normal; font-size: 90%}
.mjx-annotation-xml {line-height: normal}
.mjx-menclose > svg {fill: none; stroke: currentColor}
.mjx-mtr {display: table-row}
.mjx-mlabeledtr {display: table-row}
.mjx-mtd {display: table-cell; text-align: center}
.mjx-label {display: table-row}
.mjx-box {display: inline-block}
.mjx-block {display: block}
.mjx-span {display: inline}
.mjx-char {display: block; white-space: pre}
.mjx-itable {display: inline-table; width: auto}
.mjx-row {display: table-row}
.mjx-cell {display: table-cell}
.mjx-table {display: table; width: 100%}
.mjx-line {display: block; height: 0}
.mjx-strut {width: 0; padding-top: 1em}
.mjx-vsize {width: 0}
.MJXc-space1 {margin-left: .167em}
.MJXc-space2 {margin-left: .222em}
.MJXc-space3 {margin-left: .278em}
.mjx-chartest {display: block; visibility: hidden; position: absolute; top: 0; line-height: normal; font-size: 500%}
.mjx-chartest .mjx-char {display: inline}
.mjx-chartest .mjx-box {padding-top: 1000px}
.MJXc-processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MJXc-processed {display: none}
.mjx-test {font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.mjx-test.mjx-test-display {display: table!important}
.mjx-test.mjx-test-inline {display: inline!important; margin-right: -1px}
.mjx-test.mjx-test-default {display: block!important; clear: both}
.mjx-ex-box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60ex}
.mjx-test-inline .mjx-left-box {display: inline-block; width: 0; float: left}
.mjx-test-inline .mjx-right-box {display: inline-block; width: 0; float: right}
.mjx-test-display .mjx-right-box {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
#MathJax_CHTML_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.mjx-chtml .mjx-noError {line-height: 1.2; vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
.MJXc-TeX-unknown-R {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: normal; font-weight: normal}
.MJXc-TeX-unknown-I {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: italic; font-weight: normal}
.MJXc-TeX-unknown-B {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: normal; font-weight: bold}
.MJXc-TeX-unknown-BI {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: italic; font-weight: bold}
.MJXc-TeX-ams-R {font-family: MJXc-TeX-ams-R,MJXc-TeX-ams-Rw}
.MJXc-TeX-cal-B {font-family: MJXc-TeX-cal-B,MJXc-TeX-cal-Bx,MJXc-TeX-cal-Bw}
.MJXc-TeX-frak-R {font-family: MJXc-TeX-frak-R,MJXc-TeX-frak-Rw}
.MJXc-TeX-frak-B {font-family: MJXc-TeX-frak-B,MJXc-TeX-frak-Bx,MJXc-TeX-frak-Bw}
.MJXc-TeX-math-BI {font-family: MJXc-TeX-math-BI,MJXc-TeX-math-BIx,MJXc-TeX-math-BIw}
.MJXc-TeX-sans-R {font-family: MJXc-TeX-sans-R,MJXc-TeX-sans-Rw}
.MJXc-TeX-sans-B {font-family: MJXc-TeX-sans-B,MJXc-TeX-sans-Bx,MJXc-TeX-sans-Bw}
.MJXc-TeX-sans-I {font-family: MJXc-TeX-sans-I,MJXc-TeX-sans-Ix,MJXc-TeX-sans-Iw}
.MJXc-TeX-script-R {font-family: MJXc-TeX-script-R,MJXc-TeX-script-Rw}
.MJXc-TeX-type-R {font-family: MJXc-TeX-type-R,MJXc-TeX-type-Rw}
.MJXc-TeX-cal-R {font-family: MJXc-TeX-cal-R,MJXc-TeX-cal-Rw}
.MJXc-TeX-main-B {font-family: MJXc-TeX-main-B,MJXc-TeX-main-Bx,MJXc-TeX-main-Bw}
.MJXc-TeX-main-I {font-family: MJXc-TeX-main-I,MJXc-TeX-main-Ix,MJXc-TeX-main-Iw}
.MJXc-TeX-main-R {font-family: MJXc-TeX-main-R,MJXc-TeX-main-Rw}
.MJXc-TeX-math-I {font-family: MJXc-TeX-math-I,MJXc-TeX-math-Ix,MJXc-TeX-math-Iw}
.MJXc-TeX-size1-R {font-family: MJXc-TeX-size1-R,MJXc-TeX-size1-Rw}
.MJXc-TeX-size2-R {font-family: MJXc-TeX-size2-R,MJXc-TeX-size2-Rw}
.MJXc-TeX-size3-R {font-family: MJXc-TeX-size3-R,MJXc-TeX-size3-Rw}
.MJXc-TeX-size4-R {font-family: MJXc-TeX-size4-R,MJXc-TeX-size4-Rw}
.MJXc-TeX-vec-R {font-family: MJXc-TeX-vec-R,MJXc-TeX-vec-Rw}
.MJXc-TeX-vec-B {font-family: MJXc-TeX-vec-B,MJXc-TeX-vec-Bx,MJXc-TeX-vec-Bw}
@font-face {font-family: MJXc-TeX-ams-R; src: local('MathJax_AMS'), local('MathJax_AMS-Regular')}
@font-face {font-family: MJXc-TeX-ams-Rw; src /*1*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/eot/MathJax_AMS-Regular.eot'); src /*2*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff') format('woff'), url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-B; src: local('MathJax_Caligraphic Bold'), local('MathJax_Caligraphic-Bold')}
@font-face {font-family: MJXc-TeX-cal-Bx; src: local('MathJax_Caligraphic'); font-weight: bold}
@font-face {font-family: MJXc-TeX-cal-Bw; src /*1*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Bold.eot'); src /*2*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Bold.woff') format('woff'), url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-R; src: local('MathJax_Fraktur'), local('MathJax_Fraktur-Regular')}
@font-face {font-family: MJXc-TeX-frak-Rw; src /*1*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Regular.eot'); src /*2*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Regular.woff') format('woff'), url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-B; src: local('MathJax_Fraktur Bold'), local('MathJax_Fraktur-Bold')}
@font-face {font-family: MJXc-TeX-frak-Bx; src: local('MathJax_Fraktur'); font-weight: bold}
@font-face {font-family: MJXc-TeX-frak-Bw; src /*1*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Bold.eot'); src /*2*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Bold.woff') format('woff'), url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-BI; src: local('MathJax_Math BoldItalic'), local('MathJax_Math-BoldItalic')}
@font-face {font-family: MJXc-TeX-math-BIx; src: local('MathJax_Math'); font-weight: bold; font-style: italic}
@font-face {font-family: MJXc-TeX-math-BIw; src /*1*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/eot/MathJax_Math-BoldItalic.eot'); src /*2*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/woff/MathJax_Math-BoldItalic.woff') format('woff'), url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/otf/MathJax_Math-BoldItalic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-R; src: local('MathJax_SansSerif'), local('MathJax_SansSerif-Regular')}
@font-face {font-family: MJXc-TeX-sans-Rw; src /*1*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Regular.eot'); src /*2*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Regular.woff') format('woff'), url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-B; src: local('MathJax_SansSerif Bold'), local('MathJax_SansSerif-Bold')}
@font-face {font-family: MJXc-TeX-sans-Bx; src: local('MathJax_SansSerif'); font-weight: bold}
@font-face {font-family: MJXc-TeX-sans-Bw; src /*1*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Bold.eot'); src /*2*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Bold.woff') format('woff'), url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-I; src: local('MathJax_SansSerif Italic'), local('MathJax_SansSerif-Italic')}
@font-face {font-family: MJXc-TeX-sans-Ix; src: local('MathJax_SansSerif'); font-style: italic}
@font-face {font-family: MJXc-TeX-sans-Iw; src /*1*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Italic.eot'); src /*2*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Italic.woff') format('woff'), url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-script-R; src: local('MathJax_Script'), local('MathJax_Script-Regular')}
@font-face {font-family: MJXc-TeX-script-Rw; src /*1*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/eot/MathJax_Script-Regular.eot'); src /*2*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/woff/MathJax_Script-Regular.woff') format('woff'), url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-type-R; src: local('MathJax_Typewriter'), local('MathJax_Typewriter-Regular')}
@font-face {font-family: MJXc-TeX-type-Rw; src /*1*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/eot/MathJax_Typewriter-Regular.eot'); src /*2*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/woff/MathJax_Typewriter-Regular.woff') format('woff'), url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/otf/MathJax_Typewriter-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-R; src: local('MathJax_Caligraphic'), local('MathJax_Caligraphic-Regular')}
@font-face {font-family: MJXc-TeX-cal-Rw; src /*1*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Regular.eot'); src /*2*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff') format('woff'), url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-B; src: local('MathJax_Main Bold'), local('MathJax_Main-Bold')}
@font-face {font-family: MJXc-TeX-main-Bx; src: local('MathJax_Main'); font-weight: bold}
@font-face {font-family: MJXc-TeX-main-Bw; src /*1*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/eot/MathJax_Main-Bold.eot'); src /*2*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff') format('woff'), url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-I; src: local('MathJax_Main Italic'), local('MathJax_Main-Italic')}
@font-face {font-family: MJXc-TeX-main-Ix; src: local('MathJax_Main'); font-style: italic}
@font-face {font-family: MJXc-TeX-main-Iw; src /*1*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/eot/MathJax_Main-Italic.eot'); src /*2*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff') format('woff'), url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-R; src: local('MathJax_Main'), local('MathJax_Main-Regular')}
@font-face {font-family: MJXc-TeX-main-Rw; src /*1*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/eot/MathJax_Main-Regular.eot'); src /*2*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff') format('woff'), url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-I; src: local('MathJax_Math Italic'), local('MathJax_Math-Italic')}
@font-face {font-family: MJXc-TeX-math-Ix; src: local('MathJax_Math'); font-style: italic}
@font-face {font-family: MJXc-TeX-math-Iw; src /*1*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/eot/MathJax_Math-Italic.eot'); src /*2*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff') format('woff'), url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size1-R; src: local('MathJax_Size1'), local('MathJax_Size1-Regular')}
@font-face {font-family: MJXc-TeX-size1-Rw; src /*1*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/eot/MathJax_Size1-Regular.eot'); src /*2*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff') format('woff'), url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size2-R; src: local('MathJax_Size2'), local('MathJax_Size2-Regular')}
@font-face {font-family: MJXc-TeX-size2-Rw; src /*1*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/eot/MathJax_Size2-Regular.eot'); src /*2*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff') format('woff'), url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size3-R; src: local('MathJax_Size3'), local('MathJax_Size3-Regular')}
@font-face {font-family: MJXc-TeX-size3-Rw; src /*1*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/eot/MathJax_Size3-Regular.eot'); src /*2*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff') format('woff'), url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size4-R; src: local('MathJax_Size4'), local('MathJax_Size4-Regular')}
@font-face {font-family: MJXc-TeX-size4-Rw; src /*1*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/eot/MathJax_Size4-Regular.eot'); src /*2*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff') format('woff'), url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-vec-R; src: local('MathJax_Vector'), local('MathJax_Vector-Regular')}
@font-face {font-family: MJXc-TeX-vec-Rw; src /*1*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/eot/MathJax_Vector-Regular.eot'); src /*2*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/woff/MathJax_Vector-Regular.woff') format('woff'), url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/otf/MathJax_Vector-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-vec-B; src: local('MathJax_Vector Bold'), local('MathJax_Vector-Bold')}
@font-face {font-family: MJXc-TeX-vec-Bx; src: local('MathJax_Vector'); font-weight: bold}
@font-face {font-family: MJXc-TeX-vec-Bw; src /*1*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/eot/MathJax_Vector-Bold.eot'); src /*2*/: url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/woff/MathJax_Vector-Bold.woff') format('woff'), url('https://web.archive.org/web/20210423082804/https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/fonts/HTML-CSS/TeX/otf/MathJax_Vector-Bold.otf') format('opentype')}
</style></head>
    <body><div id="MathJax_Message" style="display: none;"></div><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display: block; direction: ltr;">
</div><div id="wm-ipp-print">The Wayback Machine - https://web.archive.org/web/20210423082804/https://www.samsonzhang.com/2020/11/24/understanding-the-math-behind-neural-networks-by-building-one-from-scratch-no-tf-keras-just-numpy.html</div>
<script type="text/javascript">//<![CDATA[
__wm.bt(700,27,25,2,"web","https://www.samsonzhang.com/2020/11/24/understanding-the-math-behind-neural-networks-by-building-one-from-scratch-no-tf-keras-just-numpy.html","20210423082804",1996,"/_static/",["/_static/css/banner-styles.css?v=S1zqJCYt","/_static/css/iconochive.css?v=qtvMKcIJ"], false);
  __wm.rw(1);
//]]></script>
<!-- END WAYBACK TOOLBAR INSERT -->
 
        <div class="home-header sticky">
    <div class="container">
        <div class="name"><a href="https://web.archive.org/web/20210423082804/https://www.samsonzhang.com/"><span>Samson<br>Zhang</span></a></div>
        <div class="name name-small"><a href="https://web.archive.org/web/20210423082804/https://www.samsonzhang.com/"><span>s.zhang</span></a></div>
        <div class="nav-item menu-button"><span><i class="fas fa-bars"></i>
    Menu</span></div>
        <div class="nav">
            <div class="nav-item close-menu"><i class="fas fa-times"></i></div>
            <a href="https://web.archive.org/web/20210423082804/https://www.samsonzhang.com/film" class="nav-item">Film</a>
            <a href="https://web.archive.org/web/20210423082804/https://www.samsonzhang.com/photo" class="nav-item">Photo</a>
            <a href="https://web.archive.org/web/20210423082804/https://www.samsonzhang.com/building" class="nav-item">Code &amp; Building</a>
            <a href="https://web.archive.org/web/20210423082804/https://www.samsonzhang.com/design" class="nav-item">Design</a>
            <a href="https://web.archive.org/web/20210423082804/https://www.samsonzhang.com/blog" class="nav-item">Blog</a>
            <a href="https://web.archive.org/web/20210423082804/https://www.samsonzhang.com/about" class="nav-item">About</a>
        </div>
    </div>
</div>
<script>
$(".menu-button").on('click',function(){
    console.log("hi");
    $('.nav').addClass("active");
});
$(".close-menu").on('click',function(){
    $('.nav').removeClass("active");
});

$(window).scroll(function () {
    if ($(window).scrollTop() > 64){
        $('.home-header').addClass("sticky");
    }
    else{
        $('.home-header').removeClass("sticky");
    }
});
</script>

<div class="home-header-spacer"></div>
        <div class="container">
            <div class="post-container">
    <div class="backhome"><a href="https://web.archive.org/web/20210423082804/https://www.samsonzhang.com/blog"><i class="fas fa-arrow-left"></i> All Blog Posts</a></div>

    <h1>Understanding the math behind neural networks by building one from scratch (no TF/Keras, just numpy)</h1>
    <div class="categories">
        
        <div class="category cat-project"><a href="https://web.archive.org/web/20210423082804/https://www.samsonzhang.com/blog/project"><span>#project</span></a></div>
        
        <div class="category cat-machine-learning"><a href="https://web.archive.org/web/20210423082804/https://www.samsonzhang.com/blog/machine-learning"><span>#machine-learning</span></a></div>
        
        <div class="category cat-code"><a href="https://web.archive.org/web/20210423082804/https://www.samsonzhang.com/blog/code"><span>#code</span></a></div>
        
    </div>
    
    <div class="date"><span>November 24, 2020</span></div>

    <div class="readingtime"><span>
13 min read

</span></div>
    
    <div class="yt-container"><iframe src="./Understanding_files/w8yWXqWQYmU.html" frameborder="0" allowfullscreen=""></iframe></div>

<p>Anybody with even a passing interest in AI/ML likely knows the basics about neural networks. You connect a couple of layers of nodes with weights and biases, train it on some data, and bam, you’ve got a networik that can recognize cats or predict stock prices.</p>

<p>I always found this high-level understanding a little wishy-washy, though. Even when working through Kaggle courses over the summer, fully building out these models in Tensorflow, I felt like I didn’t understand what was going on or what I should be paying attention to in the code.</p>

<p>I didn’t start building this intuition until taking <a href="https://web.archive.org/web/20210423082804/https://www.coursera.org/learn/machine-learning">Andrew Ng’s Intro to ML course on Coursera</a>, which taught ML principles and algorithms not using Tensorflow or Keras — the course assignments used Matlab — but through the underlying math and equations that make these models tick. For me, this concrete technical understanding was a huge boost for my understanding of ML overall. I visualized gradient descent for a simple linear regression model in <a href="https://web.archive.org/web/20210423082804/https://www.samsonzhang.com/2020/09/27/how-excel-calculates-trendlines-and-how-you-can-too-an-introduction-to-gradient-descent-the-most-important-machine-learning-algorithm.html">a blog post two months ago</a>. To further solidify my learning, I spent a few hours in the past few days <strong>building a simple neural network from scratch</strong>, and trained it to recognize handwritten digits from the MNIST dataset.</p>

<p>In this blog post, I’ll be giving an explanation of the math behind neural networks, and a walkthrough of how I implemented it using numpy.</p>

<hr>

<p>If you just want to see the code and don’t need a ton of explanation, have a look at <a href="https://web.archive.org/web/20210423082804/https://www.kaggle.com/wwsalmon/simple-mnist-nn-from-scratch-numpy-no-tf-keras">my Kaggle notebook for the project</a>.</p>

<hr>

<h2 id="problem-statement">Problem Statement</h2>

<p>The dataset we’re working with is the famous MNIST handwritten digit dataset, commonly used for instructive ML and computer vision projects. It contains 28 x 28 grayscale images of handwritten digits that look like this:</p>

<p><img src="./Understanding_files/nn.png" alt=""></p>

<p>Each image is accompanied by a label of what digit it belongs to, from 0 to 9. Our task is to build a network that takes in an image like this and predicts what digit is written in it.</p>

<h2 id="neural-network-overview">Neural Network Overview</h2>

<p>Our network will have three layers total: an input layer and two layers with parameters. Because the input layer has no parameters, this network would be referred to as a <strong>two-layer neural network.</strong></p>

<p>The input layer has 784 nodes, corresponding to each of the 784 pixels in the 28x28 input image. Each pixel has a value between 0 and 255, with 0 being black and 255 being white. It’s common to <strong>normalize</strong> these values — getting all values between 0 and 1, here by simply dividing by 255 — before feeding them in the network.</p>

<p>The second layer, or hidden layer, could have any amount of nodes, but we’ve made it really simple here with just 10 nodes. The value of each of these nodes is calculated based on weights and biases applied to the value of the 784 nodes in the input layer. After this calculation, a ReLU activation is applied to all nodes in the layer (more on this later).</p>

<p>In a deeper network, there may be multiple hidden layers back to back before the output layer. In this network, we’ll only have one hidden layer before going to the output.</p>

<p>The output layer also has 10 nodes, corresponding to each of the output classes (digits 0 to 9). The value of each of these nodes will again be calculated from weights and biases applied to the value of the 10 nodes in the hidden layer, with a softmax activation applied to them to get the final output.</p>

<p><img src="./Understanding_files/nn1.png" alt=""></p>

<p>The process of taking an image input and running through the neural network to get a prediction is called <strong>forward propagation.</strong> The prediction that is made from a given image depends on the <strong>weights and biases, or parameters,</strong> of the network.</p>

<p>To train a neural network, then, we need to update these weights and biases to produce accurate predictions. We do this through a process called <strong>gradient descent.</strong> The basic idea of gradient descent is to figure out what direction each parameter can go in to decrease error by the greatest amount, then nudge each parameter in its corresponding direction over and over again until the parameters for minimum error and highest accuracy are found. Check out my <a href="https://web.archive.org/web/20210423082804/https://www.samsonzhang.com/2020/09/27/how-excel-calculates-trendlines-and-how-you-can-too-an-introduction-to-gradient-descent-the-most-important-machine-learning-algorithm.html">visualization of gradient descent here</a>.</p>

<p>In a neural network, gradient descent is carried out via a process called backward propagation, or backprop. In backprop, instead of taking an input image and running it forwards through the network to get a prediction, we take the previously made prediction, calculate an error of how off it was from the actual value, then run this error backwards through the network to find out how much each weight and bias parameter contributed to this error. Once we have these error derivative terms, we can nudge our weights and biases accordingly to improve our model. Do it enough times, and we’ll have a neural network that can recognize handwritten digits accurately.</p>

<h2 id="the-math">The Math</h2>

<p>That’s the high level overview — now let’s get into the math. This section contains quite a lot of matrix/vector operations, and just a little calculus, so be prepared!</p>

<h3 id="representing-our-data">Representing our data</h3>

<p>As mentioned earlier, each training example can be represented by a vector with 784 elements, corresponding to each of the image’s 784 pixels.</p>

<p>These vectors can be stacked together in a matrix to carry out vectorized calculations. That is, instead of using a for loop to go over all training examples, we can calculate error from all examples at once with matrix operations.</p>

<p>In most contexts, including for machine learning, the convention is to stack these vectors as rows of the matrix, giving the matrix dimensions of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-1-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mspace width=&quot;mediummathspace&quot; /&gt;&lt;mtext&gt;rows&lt;/mtext&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mspace width=&quot;mediummathspace&quot; /&gt;&lt;mtext&gt;columns&lt;/mtext&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2" class="mjx-mrow"><span id="MJXc-Node-3" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">m</span></span><span id="MJXc-Node-4" class="mjx-mspace" style="width: 0.222em; height: 0px;"></span><span id="MJXc-Node-5" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.181em; padding-bottom: 0.359em;">rows</span></span><span id="MJXc-Node-6" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.315em;">×</span></span><span id="MJXc-Node-7" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">n</span></span><span id="MJXc-Node-8" class="mjx-mspace" style="width: 0.222em; height: 0px;"></span><span id="MJXc-Node-9" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.359em;">columns</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mspace width="mediummathspace"></mspace><mtext>rows</mtext><mo>×</mo><mi>n</mi><mspace width="mediummathspace"></mspace><mtext>columns</mtext></math></span></span><script type="math/tex" id="MathJax-Element-1">m \: \text{rows} \times n \: \text{columns}</script>, where <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-2-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-10" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-11" class="mjx-mrow"><span id="MJXc-Node-12" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">m</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">m</script> is the number of training examples and <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-3-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-13" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-14" class="mjx-mrow"><span id="MJXc-Node-15" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">n</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">n</script> is the number of features, in this case 784. To make our math easier, we’re going to transpose this matrix, giving it dimensions <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-4-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-16" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-17" class="mjx-mrow"><span id="MJXc-Node-18" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">n</span></span><span id="MJXc-Node-19" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.315em;">×</span></span><span id="MJXc-Node-20" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">m</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>×</mo><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">n \times m</script> instead, with each column corresponding to a training example and each row a training feature.</p>

<p><img src="./Understanding_files/nn2.png" alt=""></p>

<h3 id="representing-weights-and-biases">Representing weights and biases</h3>

<p>Let’s look at our neural network now. Between every two layers is a set of connections between every node in the previous layer and every node in the following one. That is, there is a weight <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-5-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-21" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-22" class="mjx-mrow"><span id="MJXc-Node-23" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-24" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-25" class="mjx-texatom" style=""><span id="MJXc-Node-26" class="mjx-mrow"><span id="MJXc-Node-27" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em;">i</span></span><span id="MJXc-Node-28" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.176em; padding-bottom: 0.538em;">,</span></span><span id="MJXc-Node-29" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.493em;">j</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-5">w_{i,j}</script> for every <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-6-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-30" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-31" class="mjx-mrow"><span id="MJXc-Node-32" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em;">i</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">i</script> in the number of nodes in the previous layer and every <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-7-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-33" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-34" class="mjx-mrow"><span id="MJXc-Node-35" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.493em;">j</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">j</script> in the number of nodes in the following one.</p>

<p>It’s natural, then, to represent our weights as a matrix of dimensions <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-8-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-36" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-37" class="mjx-mrow"><span id="MJXc-Node-38" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-39" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">n</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-40" class="mjx-texatom" style=""><span id="MJXc-Node-41" class="mjx-mrow"><span id="MJXc-Node-42" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-43" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">l</span></span><span id="MJXc-Node-44" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-45" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.315em;">×</span></span><span id="MJXc-Node-46" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-47" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">n</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-48" class="mjx-texatom" style=""><span id="MJXc-Node-49" class="mjx-mrow"><span id="MJXc-Node-50" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-51" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">l</span></span><span id="MJXc-Node-52" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">−</span></span><span id="MJXc-Node-53" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-54" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup><mo>×</mo><msup><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mi>l</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-8">n^{[l]}\times n^{[l-1]}</script>, where <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-9-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-55" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-56" class="mjx-mrow"><span id="MJXc-Node-57" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-58" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">n</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-59" class="mjx-texatom" style=""><span id="MJXc-Node-60" class="mjx-mrow"><span id="MJXc-Node-61" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-62" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">l</span></span><span id="MJXc-Node-63" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">−</span></span><span id="MJXc-Node-64" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-65" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mi>l</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-9">n^{[l-1]}</script> is the number of nodes in the previous layer and <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-10-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-66" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-67" class="mjx-mrow"><span id="MJXc-Node-68" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-69" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">n</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-70" class="mjx-texatom" style=""><span id="MJXc-Node-71" class="mjx-mrow"><span id="MJXc-Node-72" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-73" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">l</span></span><span id="MJXc-Node-74" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-10">n^{[l]}</script>is the number of nodes in the following layer. Let’s call this matrix <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-11-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-75" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-76" class="mjx-mrow"><span id="MJXc-Node-77" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-78" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-79" class="mjx-texatom" style=""><span id="MJXc-Node-80" class="mjx-mrow"><span id="MJXc-Node-81" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-82" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">l</span></span><span id="MJXc-Node-83" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-11">W^{[l]}</script>, corresponding to layer <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-12-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-84" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-85" class="mjx-mrow"><span id="MJXc-Node-86" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">l</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">l</script> of our network. <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-13-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-87" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-88" class="mjx-mrow"><span id="MJXc-Node-89" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-90" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-91" class="mjx-texatom" style=""><span id="MJXc-Node-92" class="mjx-mrow"><span id="MJXc-Node-93" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-94" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-95" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-13">W^{[1]}</script>, for example, will be a <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-14-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;784&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-96" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-97" class="mjx-mrow"><span id="MJXc-Node-98" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">10</span></span><span id="MJXc-Node-99" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.315em;">×</span></span><span id="MJXc-Node-100" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.359em;">784</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>10</mn><mo>×</mo><mn>784</mn></math></span></span><script type="math/tex" id="MathJax-Element-14">10\times784</script> matrix, taking us from the 784 nodes of the input layer to the 10 nodes of the first hidden layer. <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-15-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-101" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-102" class="mjx-mrow"><span id="MJXc-Node-103" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-104" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-105" class="mjx-texatom" style=""><span id="MJXc-Node-106" class="mjx-mrow"><span id="MJXc-Node-107" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-108" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-109" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-15">W^{[2]}</script> will have dimensions <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-16-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-110" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-111" class="mjx-mrow"><span id="MJXc-Node-112" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">10</span></span><span id="MJXc-Node-113" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.315em;">×</span></span><span id="MJXc-Node-114" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">10</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>10</mn><mo>×</mo><mn>10</mn></math></span></span><script type="math/tex" id="MathJax-Element-16">10\times10</script>.</p>

<p>Biases are simply constant terms added to each node of the following layer, so we can represent it as a matrix with dimensions <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-17-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-115" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-116" class="mjx-mrow"><span id="MJXc-Node-117" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-118" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">n</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-119" class="mjx-texatom" style=""><span id="MJXc-Node-120" class="mjx-mrow"><span id="MJXc-Node-121" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-122" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">l</span></span><span id="MJXc-Node-123" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-124" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.315em;">×</span></span><span id="MJXc-Node-125" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup><mo>×</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-17">n^{[l]}\times 1</script>. Let’s call these matrices <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-18-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-126" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-127" class="mjx-mrow"><span id="MJXc-Node-128" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-129" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-130" class="mjx-texatom" style=""><span id="MJXc-Node-131" class="mjx-mrow"><span id="MJXc-Node-132" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-133" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">l</span></span><span id="MJXc-Node-134" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-18">b^{[l]}</script>, so that <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-19-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-135" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-136" class="mjx-mrow"><span id="MJXc-Node-137" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-138" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-139" class="mjx-texatom" style=""><span id="MJXc-Node-140" class="mjx-mrow"><span id="MJXc-Node-141" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-142" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-143" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-19">b^{[1]}</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-20-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-144" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-145" class="mjx-mrow"><span id="MJXc-Node-146" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-147" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-148" class="mjx-texatom" style=""><span id="MJXc-Node-149" class="mjx-mrow"><span id="MJXc-Node-150" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-151" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-152" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-20">b^{[2]}</script> both have dimensions <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-21-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-153" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-154" class="mjx-mrow"><span id="MJXc-Node-155" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">10</span></span><span id="MJXc-Node-156" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.315em;">×</span></span><span id="MJXc-Node-157" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>10</mn><mo>×</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-21">10\times1</script>.</p>

<h3 id="forward-propagation">Forward propagation</h3>

<p>With these representations in mind, we can now write the equations for forward propagation.</p>

<p>First, we’ll compute the unactivated values of the nodes in the first hidden layer by applying <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-22-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-158" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-159" class="mjx-mrow"><span id="MJXc-Node-160" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-161" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-162" class="mjx-texatom" style=""><span id="MJXc-Node-163" class="mjx-mrow"><span id="MJXc-Node-164" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-165" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-166" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-22">W^{[1]}</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-23-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-167" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-168" class="mjx-mrow"><span id="MJXc-Node-169" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-170" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-171" class="mjx-texatom" style=""><span id="MJXc-Node-172" class="mjx-mrow"><span id="MJXc-Node-173" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-174" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-175" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-23">b^{[1]}</script> to our input layer. We’ll call the output of this operation <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-24-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-176" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-177" class="mjx-mrow"><span id="MJXc-Node-178" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-179" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-180" class="mjx-texatom" style=""><span id="MJXc-Node-181" class="mjx-mrow"><span id="MJXc-Node-182" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-183" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-184" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-24">Z^{[1]}</script>:</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-25-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-185" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-186" class="mjx-mrow"><span id="MJXc-Node-187" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-188" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-189" class="mjx-texatom" style=""><span id="MJXc-Node-190" class="mjx-mrow"><span id="MJXc-Node-191" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-192" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-193" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-194" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-195" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-196" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-197" class="mjx-texatom" style=""><span id="MJXc-Node-198" class="mjx-mrow"><span id="MJXc-Node-199" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-200" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-201" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-202" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-203" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">+</span></span><span id="MJXc-Node-204" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-205" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-206" class="mjx-texatom" style=""><span id="MJXc-Node-207" class="mjx-mrow"><span id="MJXc-Node-208" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-209" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-210" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mi>X</mi><mo>+</mo><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-25">Z^{[1]} = W^{[1]}X+b^{[1]}</script>

<p>Remember that <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-26-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-211" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-212" class="mjx-mrow"><span id="MJXc-Node-213" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-26">X</script> has dimensions <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-27-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;784&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-214" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-215" class="mjx-mrow"><span id="MJXc-Node-216" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.359em;">784</span></span><span id="MJXc-Node-217" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.315em;">×</span></span><span id="MJXc-Node-218" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">m</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>784</mn><mo>×</mo><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">784\times m</script>, and <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-28-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace width=&quot;mediummathspace&quot; /&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;784&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-219" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-220" class="mjx-mrow"><span id="MJXc-Node-221" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-222" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-223" class="mjx-texatom" style=""><span id="MJXc-Node-224" class="mjx-mrow"><span id="MJXc-Node-225" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-226" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-227" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-228" class="mjx-mspace" style="width: 0.222em; height: 0px;"></span><span id="MJXc-Node-229" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">10</span></span><span id="MJXc-Node-230" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.315em;">×</span></span><span id="MJXc-Node-231" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.359em;">784</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mspace width="mediummathspace"></mspace><mn>10</mn><mo>×</mo><mn>784</mn></math></span></span><script type="math/tex" id="MathJax-Element-28">W^{[1]} \: 10\times784</script>. <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-29-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-232" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-233" class="mjx-mrow"><span id="MJXc-Node-234" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-235" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-236" class="mjx-texatom" style=""><span id="MJXc-Node-237" class="mjx-mrow"><span id="MJXc-Node-238" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-239" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-240" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-241" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">W^{[1]}X</script> is the dot product between the two, yielding a new matrix of dimensions <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-30-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-242" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-243" class="mjx-mrow"><span id="MJXc-Node-244" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">10</span></span><span id="MJXc-Node-245" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.315em;">×</span></span><span id="MJXc-Node-246" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">m</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>10</mn><mo>×</mo><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">10\times m</script>. This may seem a little strange at first, but think of it this way: each column of this matrix corresponds to the unactivated values for the nodes in the first hidden layer when carried out for one training example, so the entire matrix represents carrying out the first step of forward propagation for <strong>all training examples at the same time.</strong> This is much more efficient than a for loop, and is what was referred to earlier as a “vectorized implementation.”</p>

<p>Our bias term <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-31-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-247" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-248" class="mjx-mrow"><span id="MJXc-Node-249" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-250" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-251" class="mjx-texatom" style=""><span id="MJXc-Node-252" class="mjx-mrow"><span id="MJXc-Node-253" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-254" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-255" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-31">b^{[1]}</script>has dimensions <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-32-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-256" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-257" class="mjx-mrow"><span id="MJXc-Node-258" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">10</span></span><span id="MJXc-Node-259" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.315em;">×</span></span><span id="MJXc-Node-260" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>10</mn><mo>×</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-32">10\times1</script>, but we want the same column of biases to be applied to all <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-33-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-261" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-262" class="mjx-mrow"><span id="MJXc-Node-263" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">m</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">m</script> columns of training examples, so <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-34-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-264" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-265" class="mjx-mrow"><span id="MJXc-Node-266" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-267" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-268" class="mjx-texatom" style=""><span id="MJXc-Node-269" class="mjx-mrow"><span id="MJXc-Node-270" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-271" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-272" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-34">b^{[1]}</script>is effectively broadcast into a matrix of dimensions <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-35-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-273" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-274" class="mjx-mrow"><span id="MJXc-Node-275" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">10</span></span><span id="MJXc-Node-276" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.315em;">×</span></span><span id="MJXc-Node-277" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">m</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>10</mn><mo>×</mo><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">10\times m</script> when calculating <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-36-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-278" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-279" class="mjx-mrow"><span id="MJXc-Node-280" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-281" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-282" class="mjx-texatom" style=""><span id="MJXc-Node-283" class="mjx-mrow"><span id="MJXc-Node-284" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-285" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-286" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-36">Z^{[1]}</script>, matching the dimensions of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-37-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-287" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-288" class="mjx-mrow"><span id="MJXc-Node-289" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-290" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-291" class="mjx-texatom" style=""><span id="MJXc-Node-292" class="mjx-mrow"><span id="MJXc-Node-293" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-294" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-295" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-296" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-37">W^{[1]}X</script>.</p>

<p>We need to do one more calculation before moving on to the next layer, though, and that’s applying a non-linear activation to <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-38-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-297" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-298" class="mjx-mrow"><span id="MJXc-Node-299" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-300" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-301" class="mjx-texatom" style=""><span id="MJXc-Node-302" class="mjx-mrow"><span id="MJXc-Node-303" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-304" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-305" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-38">Z^{[1]}</script>. What does this mean, and why do we have to do it?</p>

<p>Imagine that we didn’t do anything to <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-39-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-306" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-307" class="mjx-mrow"><span id="MJXc-Node-308" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-309" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-310" class="mjx-texatom" style=""><span id="MJXc-Node-311" class="mjx-mrow"><span id="MJXc-Node-312" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-313" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-314" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-39">Z^{[1]}</script> now, and multiplied it by <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-40-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-315" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-316" class="mjx-mrow"><span id="MJXc-Node-317" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-318" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-319" class="mjx-texatom" style=""><span id="MJXc-Node-320" class="mjx-mrow"><span id="MJXc-Node-321" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-322" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-323" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-40">W^{[2]}</script> and added <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-41-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-324" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-325" class="mjx-mrow"><span id="MJXc-Node-326" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-327" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-328" class="mjx-texatom" style=""><span id="MJXc-Node-329" class="mjx-mrow"><span id="MJXc-Node-330" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-331" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-332" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-41">b^{[2]}</script> to get the value for the next layer. <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-42-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-333" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-334" class="mjx-mrow"><span id="MJXc-Node-335" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-336" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-337" class="mjx-texatom" style=""><span id="MJXc-Node-338" class="mjx-mrow"><span id="MJXc-Node-339" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-340" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-341" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-42">Z^{[1]}</script> is a linear combination of the input features, and the second layer would be a linear combination of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-43-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-342" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-343" class="mjx-mrow"><span id="MJXc-Node-344" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-345" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-346" class="mjx-texatom" style=""><span id="MJXc-Node-347" class="mjx-mrow"><span id="MJXc-Node-348" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-349" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-350" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-43">Z^{[1]}</script>, making it still a linear combination of the input features. That means that our hidden layer is essentially useless, and we’re just building a linear regression model.</p>

<p>To prevent this reduction and actually add complexity with our layers, we’ll run <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-44-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-351" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-352" class="mjx-mrow"><span id="MJXc-Node-353" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-354" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-355" class="mjx-texatom" style=""><span id="MJXc-Node-356" class="mjx-mrow"><span id="MJXc-Node-357" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-358" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-359" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-44">Z^{[1]}</script> through a non-linear activation function before passing it off to the next layer. In this case, we’ll be using a function called a rectified linear unit, or ReLU:</p>

<p><img src="./Understanding_files/nn3.png" alt=""></p>

<p>ReLU is a really simple function: it’s linear if the input value is above 0, and outputs 0 otherwise. Just this much, though, is enough to ensure that our model doesn’t collapse to a linear one.</p>

<p>From <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-45-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-360" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-361" class="mjx-mrow"><span id="MJXc-Node-362" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-363" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-364" class="mjx-texatom" style=""><span id="MJXc-Node-365" class="mjx-mrow"><span id="MJXc-Node-366" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-367" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-368" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-45">Z^{[1]}</script>, we’ll calculate a value <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-46-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-369" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-370" class="mjx-mrow"><span id="MJXc-Node-371" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-372" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-373" class="mjx-texatom" style=""><span id="MJXc-Node-374" class="mjx-mrow"><span id="MJXc-Node-375" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-376" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-377" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-46">A^{[1]}</script> for the values of the nodes in the hidden layer of our neural network after applying our activation function to it:</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-47-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;ReLU&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-378" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-379" class="mjx-mrow"><span id="MJXc-Node-380" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-381" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-382" class="mjx-texatom" style=""><span id="MJXc-Node-383" class="mjx-mrow"><span id="MJXc-Node-384" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-385" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-386" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-387" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-388" class="mjx-mtext MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.359em;">ReLU</span></span><span id="MJXc-Node-389" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">(</span></span><span id="MJXc-Node-390" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-391" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-392" class="mjx-texatom" style=""><span id="MJXc-Node-393" class="mjx-mrow"><span id="MJXc-Node-394" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-395" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-396" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-397" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><mtext>ReLU</mtext><mo stretchy="false">(</mo><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-47">A^{[1]} = \text{ReLU}(Z^{[1]})</script>

<p>More generally, you might see this written as <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-48-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-398" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-399" class="mjx-mrow"><span id="MJXc-Node-400" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-401" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-402" class="mjx-texatom" style=""><span id="MJXc-Node-403" class="mjx-mrow"><span id="MJXc-Node-404" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-405" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">l</span></span><span id="MJXc-Node-406" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-407" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-408" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.493em; padding-right: 0.003em;">g</span></span><span id="MJXc-Node-409" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">(</span></span><span id="MJXc-Node-410" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-411" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-412" class="mjx-texatom" style=""><span id="MJXc-Node-413" class="mjx-mrow"><span id="MJXc-Node-414" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-415" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">l</span></span><span id="MJXc-Node-416" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-417" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-48">A^{[l]} = g(Z^{[l]})</script>, with <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-49-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-418" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-419" class="mjx-mrow"><span id="MJXc-Node-420" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.493em; padding-right: 0.003em;">g</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-49">g</script> referring to an arbitrary activation function that may be something other than ReLU.</p>

<p>Once we have <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-50-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-421" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-422" class="mjx-mrow"><span id="MJXc-Node-423" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-424" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-425" class="mjx-texatom" style=""><span id="MJXc-Node-426" class="mjx-mrow"><span id="MJXc-Node-427" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-428" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-429" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-50">A^{[1]}</script>, we can proceed to calculating the values for our second layer, which is also our output layer. First, we calculate <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-51-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-430" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-431" class="mjx-mrow"><span id="MJXc-Node-432" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-433" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-434" class="mjx-texatom" style=""><span id="MJXc-Node-435" class="mjx-mrow"><span id="MJXc-Node-436" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-437" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-438" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-51">Z^{[2]}</script>:</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-52-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-439" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-440" class="mjx-mrow"><span id="MJXc-Node-441" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-442" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-443" class="mjx-texatom" style=""><span id="MJXc-Node-444" class="mjx-mrow"><span id="MJXc-Node-445" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-446" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-447" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-448" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-449" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-450" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-451" class="mjx-texatom" style=""><span id="MJXc-Node-452" class="mjx-mrow"><span id="MJXc-Node-453" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-454" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-455" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-456" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-457" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-458" class="mjx-texatom" style=""><span id="MJXc-Node-459" class="mjx-mrow"><span id="MJXc-Node-460" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-461" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-462" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-463" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">+</span></span><span id="MJXc-Node-464" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-465" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-466" class="mjx-texatom" style=""><span id="MJXc-Node-467" class="mjx-mrow"><span id="MJXc-Node-468" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-469" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-470" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>+</mo><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-52">Z^{[2]} = W^{[2]}A^{[1]}+b^{[2]}</script>

<p>Then, we’ll apply an activation function to <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-53-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-471" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-472" class="mjx-mrow"><span id="MJXc-Node-473" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-474" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-475" class="mjx-texatom" style=""><span id="MJXc-Node-476" class="mjx-mrow"><span id="MJXc-Node-477" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-478" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-479" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-53">Z^{[2]}</script> to get our final output.</p>

<p>If this second layer were just another hidden layer, with more hidden layers or an output layer after it, we would apply ReLU again. But since it’s the output layer, we’ll apply a special activation function called softmax:</p>

<p><img src="./Understanding_files/nn4.png" alt=""></p>

<p>Diagram by <a href="https://web.archive.org/web/20210423082804/https://towardsdatascience.com/softmax-activation-function-explained-a7e1bc3ad60">Bartosz Szabłowski</a> on Towards Data Science</p>

<p>Softmax takes a column of data at a time, taking each element in the column and outputting the exponential of that element divided by the sum of the exponentials of each of the elements in the input column. The end result is a column of probabilities between 0 and 1.</p>

<p>The value of using softmax for our output layer is that we can read the output as probabilities for certain predictions. In the diagram above, for example, we might read the output as a prediction that the second class has a 90% probability of being the correct label, the third a 5% probability, the fourth a 1% probability, and so on.</p>

<p>Let’s find our <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-54-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-480" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-481" class="mjx-mrow"><span id="MJXc-Node-482" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-483" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-484" class="mjx-texatom" style=""><span id="MJXc-Node-485" class="mjx-mrow"><span id="MJXc-Node-486" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-487" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-488" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-54">A^{[2]}</script>:</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-55-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;softmax&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-489" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-490" class="mjx-mrow"><span id="MJXc-Node-491" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-492" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-493" class="mjx-texatom" style=""><span id="MJXc-Node-494" class="mjx-mrow"><span id="MJXc-Node-495" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-496" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-497" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-498" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-499" class="mjx-mtext MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.359em;">softmax</span></span><span id="MJXc-Node-500" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">(</span></span><span id="MJXc-Node-501" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-502" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-503" class="mjx-texatom" style=""><span id="MJXc-Node-504" class="mjx-mrow"><span id="MJXc-Node-505" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-506" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-507" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-508" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><mtext>softmax</mtext><mo stretchy="false">(</mo><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-55">A^{[2]} = \text{softmax}(Z^{[2]})</script>

<p>Softmax runs element-wise, so the dimensions of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-56-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-509" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-510" class="mjx-mrow"><span id="MJXc-Node-511" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-512" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-513" class="mjx-texatom" style=""><span id="MJXc-Node-514" class="mjx-mrow"><span id="MJXc-Node-515" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-516" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-517" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-56">Z^{[2]}</script> are preserved at <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-57-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-518" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-519" class="mjx-mrow"><span id="MJXc-Node-520" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">10</span></span><span id="MJXc-Node-521" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.315em;">×</span></span><span id="MJXc-Node-522" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">m</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>10</mn><mo>×</mo><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-57">10\times m</script>. We can read this output matrix as follows: value <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-58-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-523" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-524" class="mjx-mrow"><span id="MJXc-Node-525" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-526" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-stack" style="vertical-align: -0.311em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-532" class="mjx-texatom" style=""><span id="MJXc-Node-533" class="mjx-mrow"><span id="MJXc-Node-534" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-535" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-536" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-527" class="mjx-texatom" style=""><span id="MJXc-Node-528" class="mjx-mrow"><span id="MJXc-Node-529" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em;">i</span></span><span id="MJXc-Node-530" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.176em; padding-bottom: 0.538em;">,</span></span><span id="MJXc-Node-531" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.493em;">j</span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-58">A^{[2]}_{i, j}</script> is the probability that example <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-59-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-537" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-538" class="mjx-mrow"><span id="MJXc-Node-539" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.493em;">j</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-59">j</script> is an image of the digit <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-60-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-540" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-541" class="mjx-mrow"><span id="MJXc-Node-542" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em;">i</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-60">i</script>.</p>

<p>With that, we’ve run through the entire neural network, going from our input <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-61-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-543" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-544" class="mjx-mrow"><span id="MJXc-Node-545" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-61">X</script> containing all of our training examples to an output matrix <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-62-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-546" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-547" class="mjx-mrow"><span id="MJXc-Node-548" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-549" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-550" class="mjx-texatom" style=""><span id="MJXc-Node-551" class="mjx-mrow"><span id="MJXc-Node-552" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-553" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-554" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-62">A^{[2]}</script> containing prediction probabilities for each example.</p>

<h3 id="backward-propagation">Backward propagation</h3>

<p>Now, we’ll go the opposite way and calculate how to nudge our parameters to carry out gradient descent.</p>

<p>Mathematically, what we’re actually computing is the derivative of the loss function with respect to each weight and bias parameter. For a softmax classifier, we’ll use a cross-entropy loss function:</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-63-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-555" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-556" class="mjx-mrow"><span id="MJXc-Node-557" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.078em;">J</span></span><span id="MJXc-Node-558" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">(</span></span><span id="MJXc-Node-559" class="mjx-texatom"><span id="MJXc-Node-560" class="mjx-mrow"><span id="MJXc-Node-561" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.083em;"><span id="MJXc-Node-563" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.315em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-562" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.493em; padding-right: 0.006em;">y</span></span></span></span></span></span></span><span id="MJXc-Node-564" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.176em; padding-bottom: 0.538em;">,</span></span><span id="MJXc-Node-565" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.493em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-566" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">)</span></span><span id="MJXc-Node-567" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-568" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">−</span></span><span id="MJXc-Node-569" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.805em;"><span id="MJXc-Node-576" class="mjx-texatom" style=""><span id="MJXc-Node-577" class="mjx-mrow"><span id="MJXc-Node-578" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">c</span></span></span></span></span><span class="mjx-op"><span id="MJXc-Node-570" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.717em; padding-bottom: 0.717em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.21em;"><span id="MJXc-Node-571" class="mjx-texatom" style=""><span id="MJXc-Node-572" class="mjx-mrow"><span id="MJXc-Node-573" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em;">i</span></span><span id="MJXc-Node-574" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-575" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0</span></span></span></span></span></span></span></span><span id="MJXc-Node-579" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-580" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.493em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-581" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em;">i</span></span></span></span><span id="MJXc-Node-582" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.538em;">log</span></span><span id="MJXc-Node-583" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-584" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">(</span></span><span id="MJXc-Node-585" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-586" class="mjx-texatom"><span id="MJXc-Node-587" class="mjx-mrow"><span id="MJXc-Node-588" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.083em;"><span id="MJXc-Node-590" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.315em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-589" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.493em; padding-right: 0.006em;">y</span></span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.375em; padding-right: 0.071em;"><span id="MJXc-Node-591" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em;">i</span></span></span></span><span id="MJXc-Node-592" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>J</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>c</mi></mrow></munderover><msub><mi>y</mi><mi>i</mi></msub><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-63">J(\hat{y}, y) = -\sum_{i=0}^{c} y_i \log(\hat{y}_i)</script>

<p>Here, <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-64-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-593" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-594" class="mjx-mrow"><span id="MJXc-Node-595" class="mjx-texatom"><span id="MJXc-Node-596" class="mjx-mrow"><span id="MJXc-Node-597" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.083em;"><span id="MJXc-Node-599" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.315em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-598" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.493em; padding-right: 0.006em;">y</span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-64">\hat{y}</script> is our prediction vector. It might look like this:</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-65-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.01&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.02&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.05&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.02&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.80&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.01&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.01&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.00&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.01&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0.07&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-600" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-601" class="mjx-mrow"><span id="MJXc-Node-602" class="mjx-mrow"><span id="MJXc-Node-603" class="mjx-mo" style="vertical-align: -5.881em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.94em; padding-bottom: 0.94em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.526em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.94em; padding-bottom: 0.94em;">⎣</span></span></span><span id="MJXc-Node-604" class="mjx-mtable" style="vertical-align: -6.55em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-605" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-606" class="mjx-mtd" style="padding: 0px; width: 1.778em;"><span id="MJXc-Node-607" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-608" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0.01</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-609" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-610" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-611" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-612" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0.02</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-613" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-614" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-615" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-616" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0.05</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-617" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-618" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-619" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-620" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0.02</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-621" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-622" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-623" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-624" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0.80</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-625" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-626" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-627" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-628" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0.01</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-629" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-630" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-631" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-632" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0.01</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-633" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-634" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-635" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-636" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0.00</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-637" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-638" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-639" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-640" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0.01</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-641" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-642" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-643" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-644" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.359em;">0.07</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-645" class="mjx-mo" style="vertical-align: -5.881em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.94em; padding-bottom: 0.94em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.526em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.94em; padding-bottom: 0.94em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0.01</mn></mtd></mtr><mtr><mtd><mn>0.02</mn></mtd></mtr><mtr><mtd><mn>0.05</mn></mtd></mtr><mtr><mtd><mn>0.02</mn></mtd></mtr><mtr><mtd><mn>0.80</mn></mtd></mtr><mtr><mtd><mn>0.01</mn></mtd></mtr><mtr><mtd><mn>0.01</mn></mtd></mtr><mtr><mtd><mn>0.00</mn></mtd></mtr><mtr><mtd><mn>0.01</mn></mtd></mtr><mtr><mtd><mn>0.07</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-65">\begin{bmatrix} 0.01 \\ 0.02 \\ 0.05 \\ 0.02 \\ 0.80 \\ 0.01 \\ 0.01 \\ 0.00 \\ 0.01 \\ 0.07 \\  \end{bmatrix}</script>

<p><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-66-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-646" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-647" class="mjx-mrow"><span id="MJXc-Node-648" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.493em; padding-right: 0.006em;">y</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-66">y</script> is the <strong>one-hot encoding</strong> of the correct label for the training example. If the label for a training example is 4, for example, the one-hot encoding of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-67-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-649" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-650" class="mjx-mrow"><span id="MJXc-Node-651" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.493em; padding-right: 0.006em;">y</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-67">y</script> would look like this:</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-68-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-652" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-653" class="mjx-mrow"><span id="MJXc-Node-654" class="mjx-mrow"><span id="MJXc-Node-655" class="mjx-mo" style="vertical-align: -5.881em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.94em; padding-bottom: 0.94em;">⎡</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.526em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.94em; padding-bottom: 0.94em;">⎣</span></span></span><span id="MJXc-Node-656" class="mjx-mtable" style="vertical-align: -6.55em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-657" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-658" class="mjx-mtd" style="padding: 0px; width: 0.5em;"><span id="MJXc-Node-659" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-660" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-661" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-662" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-663" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-664" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-665" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-666" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-667" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-668" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-669" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-670" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-671" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-672" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-673" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-674" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-675" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-676" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-677" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-678" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-679" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-680" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-681" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-682" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-683" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-684" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-685" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-686" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-687" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-688" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-689" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-690" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-691" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-692" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-693" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-694" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-695" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-696" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-697" class="mjx-mo" style="vertical-align: -5.881em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.94em; padding-bottom: 0.94em;">⎤</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.526em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.94em; padding-bottom: 0.94em;">⎦</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-68">\begin{bmatrix} 0 \\ 0 \\ 0 \\ 0 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\  \end{bmatrix}</script>

<p>Notice that in our sum <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-69-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-698" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-699" class="mjx-mrow"><span id="MJXc-Node-700" class="mjx-munderover"><span class="mjx-base"><span id="MJXc-Node-701" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.538em; padding-bottom: 0.538em;">∑</span></span></span><span class="mjx-stack" style="vertical-align: -0.31em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.422em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-707" class="mjx-texatom" style=""><span id="MJXc-Node-708" class="mjx-mrow"><span id="MJXc-Node-709" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">c</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-702" class="mjx-texatom" style=""><span id="MJXc-Node-703" class="mjx-mrow"><span id="MJXc-Node-704" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em;">i</span></span><span id="MJXc-Node-705" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-706" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0</span></span></span></span></span></span></span><span id="MJXc-Node-710" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-711" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.493em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-712" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em;">i</span></span></span></span><span id="MJXc-Node-713" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.538em;">log</span></span><span id="MJXc-Node-714" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-715" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">(</span></span><span id="MJXc-Node-716" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-717" class="mjx-texatom"><span id="MJXc-Node-718" class="mjx-mrow"><span id="MJXc-Node-719" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.083em;"><span id="MJXc-Node-721" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.315em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-720" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.493em; padding-right: 0.006em;">y</span></span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.375em; padding-right: 0.071em;"><span id="MJXc-Node-722" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em;">i</span></span></span></span><span id="MJXc-Node-723" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>c</mi></mrow></munderover><msub><mi>y</mi><mi>i</mi></msub><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-69">\sum_{i=0}^{c} y_i \log(\hat{y}_i)</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-70-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-724" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-725" class="mjx-mrow"><span id="MJXc-Node-726" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-727" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.493em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-728" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em;">i</span></span></span></span><span id="MJXc-Node-729" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-730" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-70">y_i = 0</script> for all <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-71-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-731" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-732" class="mjx-mrow"><span id="MJXc-Node-733" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em;">i</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-71">i</script> except the correct label. The loss for a given example, then, is just the log of the probability given for the correct prediction. In our example above, <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-72-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0.80&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mn&gt;0.097&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-734" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-735" class="mjx-mrow"><span id="MJXc-Node-736" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.078em;">J</span></span><span id="MJXc-Node-737" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">(</span></span><span id="MJXc-Node-738" class="mjx-texatom"><span id="MJXc-Node-739" class="mjx-mrow"><span id="MJXc-Node-740" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.083em;"><span id="MJXc-Node-742" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.315em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-741" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.493em; padding-right: 0.006em;">y</span></span></span></span></span></span></span><span id="MJXc-Node-743" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.176em; padding-bottom: 0.538em;">,</span></span><span id="MJXc-Node-744" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.493em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-745" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">)</span></span><span id="MJXc-Node-746" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-747" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">−</span></span><span id="MJXc-Node-748" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.538em;">log</span></span><span id="MJXc-Node-749" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-750" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">(</span></span><span id="MJXc-Node-751" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-752" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.493em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-753" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.359em;">4</span></span></span></span><span id="MJXc-Node-754" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">)</span></span><span id="MJXc-Node-755" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-756" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">−</span></span><span id="MJXc-Node-757" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.538em;">log</span></span><span id="MJXc-Node-758" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-759" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">(</span></span><span id="MJXc-Node-760" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0.80</span></span><span id="MJXc-Node-761" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">)</span></span><span id="MJXc-Node-762" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.181em; padding-bottom: 0.315em;">≈</span></span><span id="MJXc-Node-763" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.359em;">0.097</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mn>4</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>0.80</mn><mo stretchy="false">)</mo><mo>≈</mo><mn>0.097</mn></math></span></span><script type="math/tex" id="MathJax-Element-72">J(\hat{y}, y) = -\log(y_4) = -\log(0.80) \approx 0.097</script>. Notice that, the closer the prediction probability is to 1, the closer the loss is to 0. As the probability approaches 0, the loss approaches <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-73-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-764" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-765" class="mjx-mrow"><span id="MJXc-Node-766" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">+</span></span><span id="MJXc-Node-767" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.136em; padding-bottom: 0.359em;">∞</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mi mathvariant="normal">∞</mi></math></span></span><script type="math/tex" id="MathJax-Element-73">+\infty</script>. By minimizing the cost function, we improve the accuracy of our model. We do so by substracting the derivative of the loss function with respect to each parameter from that parameter over many rounds of graident descent:</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-74-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; min-width: 10.099em; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;:=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;:=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;:=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;:=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-768" class="mjx-math" style="width: 100%;" aria-hidden="true"><span id="MJXc-Node-769" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -9.408em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-770" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-771" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-772" class="mjx-texatom" style=""><span id="MJXc-Node-773" class="mjx-mrow"><span id="MJXc-Node-774" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-775" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-776" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-777" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.359em;">:<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">=</span></span></span><span id="MJXc-Node-778" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-779" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-780" class="mjx-texatom" style=""><span id="MJXc-Node-781" class="mjx-mrow"><span id="MJXc-Node-782" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-783" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-784" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-785" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">−</span></span><span id="MJXc-Node-786" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">α</span></span><span id="MJXc-Node-787" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 2.562em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 2.562em; top: -1.419em;"><span id="MJXc-Node-788" class="mjx-mrow"><span id="MJXc-Node-789" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.007em;">δ</span></span><span id="MJXc-Node-790" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.078em;">J</span></span></span></span><span class="mjx-denominator" style="width: 2.562em; bottom: -0.852em;"><span id="MJXc-Node-791" class="mjx-mrow"><span id="MJXc-Node-792" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.007em;">δ</span></span><span id="MJXc-Node-793" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-794" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.431em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-795" class="mjx-texatom" style=""><span id="MJXc-Node-796" class="mjx-mrow"><span id="MJXc-Node-797" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-798" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-799" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 2.562em;"></span></span><span class="mjx-vsize" style="height: 2.27em; vertical-align: -0.852em;"></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-800" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-801" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-802" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-803" class="mjx-texatom" style=""><span id="MJXc-Node-804" class="mjx-mrow"><span id="MJXc-Node-805" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-806" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-807" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-808" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.359em;">:<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">=</span></span></span><span id="MJXc-Node-809" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-810" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-811" class="mjx-texatom" style=""><span id="MJXc-Node-812" class="mjx-mrow"><span id="MJXc-Node-813" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-814" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-815" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-816" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">−</span></span><span id="MJXc-Node-817" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">α</span></span><span id="MJXc-Node-818" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.862em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.862em; top: -1.419em;"><span id="MJXc-Node-819" class="mjx-mrow"><span id="MJXc-Node-820" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.007em;">δ</span></span><span id="MJXc-Node-821" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.078em;">J</span></span></span></span><span class="mjx-denominator" style="width: 1.862em; bottom: -0.841em;"><span id="MJXc-Node-822" class="mjx-mrow"><span id="MJXc-Node-823" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.007em;">δ</span></span><span id="MJXc-Node-824" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-825" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.431em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-826" class="mjx-texatom" style=""><span id="MJXc-Node-827" class="mjx-mrow"><span id="MJXc-Node-828" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-829" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-830" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.862em;"></span></span><span class="mjx-vsize" style="height: 2.259em; vertical-align: -0.841em;"></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-831" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-832" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-833" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-834" class="mjx-texatom" style=""><span id="MJXc-Node-835" class="mjx-mrow"><span id="MJXc-Node-836" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-837" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-838" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-839" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.359em;">:<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">=</span></span></span><span id="MJXc-Node-840" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-841" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-842" class="mjx-texatom" style=""><span id="MJXc-Node-843" class="mjx-mrow"><span id="MJXc-Node-844" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-845" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-846" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-847" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">−</span></span><span id="MJXc-Node-848" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">α</span></span><span id="MJXc-Node-849" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 2.562em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 2.562em; top: -1.419em;"><span id="MJXc-Node-850" class="mjx-mrow"><span id="MJXc-Node-851" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.007em;">δ</span></span><span id="MJXc-Node-852" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.078em;">J</span></span></span></span><span class="mjx-denominator" style="width: 2.562em; bottom: -0.852em;"><span id="MJXc-Node-853" class="mjx-mrow"><span id="MJXc-Node-854" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.007em;">δ</span></span><span id="MJXc-Node-855" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-856" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.431em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-857" class="mjx-texatom" style=""><span id="MJXc-Node-858" class="mjx-mrow"><span id="MJXc-Node-859" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-860" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-861" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 2.562em;"></span></span><span class="mjx-vsize" style="height: 2.27em; vertical-align: -0.852em;"></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-862" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-863" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-864" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-865" class="mjx-texatom" style=""><span id="MJXc-Node-866" class="mjx-mrow"><span id="MJXc-Node-867" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-868" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-869" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-870" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.359em;">:<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">=</span></span></span><span id="MJXc-Node-871" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-872" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-873" class="mjx-texatom" style=""><span id="MJXc-Node-874" class="mjx-mrow"><span id="MJXc-Node-875" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-876" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-877" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-878" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">−</span></span><span id="MJXc-Node-879" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">α</span></span><span id="MJXc-Node-880" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.862em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.862em; top: -1.419em;"><span id="MJXc-Node-881" class="mjx-mrow"><span id="MJXc-Node-882" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.007em;">δ</span></span><span id="MJXc-Node-883" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.078em;">J</span></span></span></span><span class="mjx-denominator" style="width: 1.862em; bottom: -0.841em;"><span id="MJXc-Node-884" class="mjx-mrow"><span id="MJXc-Node-885" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.007em;">δ</span></span><span id="MJXc-Node-886" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-887" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.431em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-888" class="mjx-texatom" style=""><span id="MJXc-Node-889" class="mjx-mrow"><span id="MJXc-Node-890" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-891" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-892" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.862em;"></span></span><span class="mjx-vsize" style="height: 2.259em; vertical-align: -0.841em;"></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-893" class="mjx-mspace" style="width: 0px; height: 0px;"></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>:=</mo><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>−</mo><mi>α</mi><mfrac><mrow><mi>δ</mi><mi>J</mi></mrow><mrow><mi>δ</mi><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></mrow></mfrac><mspace linebreak="newline"></mspace><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>:=</mo><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>−</mo><mi>α</mi><mfrac><mrow><mi>δ</mi><mi>J</mi></mrow><mrow><mi>δ</mi><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></mrow></mfrac><mspace linebreak="newline"></mspace><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>:=</mo><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>−</mo><mi>α</mi><mfrac><mrow><mi>δ</mi><mi>J</mi></mrow><mrow><mi>δ</mi><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></mrow></mfrac><mspace linebreak="newline"></mspace><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>:=</mo><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>−</mo><mi>α</mi><mfrac><mrow><mi>δ</mi><mi>J</mi></mrow><mrow><mi>δ</mi><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></mrow></mfrac><mspace linebreak="newline"></mspace></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-74">W^{[1]} := W^{[1]} - \alpha \frac{\delta J}{\delta W^{[1]}} \\
b^{[1]} := b^{[1]} - \alpha \frac{\delta J}{\delta b^{[1]}} \\
W^{[2]} := W^{[2]} - \alpha \frac{\delta J}{\delta W^{[2]}} \\
b^{[2]} := b^{[2]} - \alpha \frac{\delta J}{\delta b^{[2]}} \\</script>

<p>Our objective in backprop is to find <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-75-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-894" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-895" class="mjx-mrow"><span id="MJXc-Node-896" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.812em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.562em; top: -1.346em;"><span id="MJXc-Node-897" class="mjx-mrow" style=""><span id="MJXc-Node-898" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.007em;">δ</span></span><span id="MJXc-Node-899" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.078em;">J</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.562em; bottom: -0.75em;"><span id="MJXc-Node-900" class="mjx-mrow" style=""><span id="MJXc-Node-901" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.007em;">δ</span></span><span id="MJXc-Node-902" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-903" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.431em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-904" class="mjx-texatom" style=""><span id="MJXc-Node-905" class="mjx-mrow"><span id="MJXc-Node-906" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-907" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-908" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.812em;"></span></span><span class="mjx-vsize" style="height: 1.482em; vertical-align: -0.53em;"></span></span><span id="MJXc-Node-909" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.176em; padding-bottom: 0.538em;">,</span></span><span id="MJXc-Node-910" class="mjx-mfrac MJXc-space1"><span class="mjx-box MJXc-stacked" style="width: 1.317em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.862em; top: -1.346em;"><span id="MJXc-Node-911" class="mjx-mrow" style=""><span id="MJXc-Node-912" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.007em;">δ</span></span><span id="MJXc-Node-913" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.078em;">J</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.862em; bottom: -0.739em;"><span id="MJXc-Node-914" class="mjx-mrow" style=""><span id="MJXc-Node-915" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.007em;">δ</span></span><span id="MJXc-Node-916" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-917" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.431em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-918" class="mjx-texatom" style=""><span id="MJXc-Node-919" class="mjx-mrow"><span id="MJXc-Node-920" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-921" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-922" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.317em;"></span></span><span class="mjx-vsize" style="height: 1.474em; vertical-align: -0.522em;"></span></span><span id="MJXc-Node-923" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.176em; padding-bottom: 0.538em;">,</span></span><span id="MJXc-Node-924" class="mjx-mfrac MJXc-space1"><span class="mjx-box MJXc-stacked" style="width: 1.812em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.562em; top: -1.346em;"><span id="MJXc-Node-925" class="mjx-mrow" style=""><span id="MJXc-Node-926" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.007em;">δ</span></span><span id="MJXc-Node-927" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.078em;">J</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.562em; bottom: -0.75em;"><span id="MJXc-Node-928" class="mjx-mrow" style=""><span id="MJXc-Node-929" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.007em;">δ</span></span><span id="MJXc-Node-930" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-931" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.431em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-932" class="mjx-texatom" style=""><span id="MJXc-Node-933" class="mjx-mrow"><span id="MJXc-Node-934" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-935" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-936" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.812em;"></span></span><span class="mjx-vsize" style="height: 1.482em; vertical-align: -0.53em;"></span></span><span id="MJXc-Node-937" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.176em; padding-bottom: 0.538em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi>δ</mi><mi>J</mi></mrow><mrow><mi>δ</mi><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></mrow></mfrac><mo>,</mo><mfrac><mrow><mi>δ</mi><mi>J</mi></mrow><mrow><mi>δ</mi><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></mrow></mfrac><mo>,</mo><mfrac><mrow><mi>δ</mi><mi>J</mi></mrow><mrow><mi>δ</mi><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></mrow></mfrac><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-75">\frac{\delta J}{\delta W^{[1]}},\frac{\delta J}{\delta b^{[1]}},\frac{\delta J}{\delta W^{[2]}},</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-76-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-938" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-939" class="mjx-mrow"><span id="MJXc-Node-940" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.317em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.862em; top: -1.346em;"><span id="MJXc-Node-941" class="mjx-mrow" style=""><span id="MJXc-Node-942" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.007em;">δ</span></span><span id="MJXc-Node-943" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.078em;">J</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.862em; bottom: -0.739em;"><span id="MJXc-Node-944" class="mjx-mrow" style=""><span id="MJXc-Node-945" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.007em;">δ</span></span><span id="MJXc-Node-946" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-947" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.431em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-948" class="mjx-texatom" style=""><span id="MJXc-Node-949" class="mjx-mrow"><span id="MJXc-Node-950" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-951" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-952" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.317em;"></span></span><span class="mjx-vsize" style="height: 1.474em; vertical-align: -0.522em;"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi>δ</mi><mi>J</mi></mrow><mrow><mi>δ</mi><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-76">\frac{\delta J}{\delta b^{[2]}}</script>. For concision, we’ll write these values as <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-77-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-953" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-954" class="mjx-mrow"><span id="MJXc-Node-955" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-956" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-957" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-958" class="mjx-texatom" style=""><span id="MJXc-Node-959" class="mjx-mrow"><span id="MJXc-Node-960" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-961" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-962" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-963" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.176em; padding-bottom: 0.538em;">,</span></span><span id="MJXc-Node-964" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-965" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-966" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-967" class="mjx-texatom" style=""><span id="MJXc-Node-968" class="mjx-mrow"><span id="MJXc-Node-969" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-970" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-971" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-972" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.176em; padding-bottom: 0.538em;">,</span></span><span id="MJXc-Node-973" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-974" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-975" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-976" class="mjx-texatom" style=""><span id="MJXc-Node-977" class="mjx-mrow"><span id="MJXc-Node-978" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-979" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-980" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-981" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.176em; padding-bottom: 0.538em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>,</mo><mi>d</mi><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>,</mo><mi>d</mi><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-77">dW^{[1]}, db^{[1]}, dW^{[2]},</script>and <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-78-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-982" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-983" class="mjx-mrow"><span id="MJXc-Node-984" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-985" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-986" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-987" class="mjx-texatom" style=""><span id="MJXc-Node-988" class="mjx-mrow"><span id="MJXc-Node-989" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-990" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-991" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-78">db^{[2]}</script>. We’ll find these values by stepping backwards through our network, starting by calculating <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-79-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-992" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-993" class="mjx-mrow"><span id="MJXc-Node-994" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.544em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.183em; top: -1.346em;"><span id="MJXc-Node-995" class="mjx-mrow" style=""><span id="MJXc-Node-996" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.007em;">δ</span></span><span id="MJXc-Node-997" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.078em;">J</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.183em; bottom: -0.738em;"><span id="MJXc-Node-998" class="mjx-mrow" style=""><span id="MJXc-Node-999" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.007em;">δ</span></span><span id="MJXc-Node-1000" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1001" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.431em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1002" class="mjx-texatom" style=""><span id="MJXc-Node-1003" class="mjx-mrow"><span id="MJXc-Node-1004" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1005" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1006" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.544em;"></span></span><span class="mjx-vsize" style="height: 1.473em; vertical-align: -0.522em;"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi>δ</mi><mi>J</mi></mrow><mrow><mi>δ</mi><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-79">\frac{\delta J}{\delta A^{[2]}}</script>, or <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-80-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1007" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1008" class="mjx-mrow"><span id="MJXc-Node-1009" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1010" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1011" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1012" class="mjx-texatom" style=""><span id="MJXc-Node-1013" class="mjx-mrow"><span id="MJXc-Node-1014" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1015" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1016" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-80">dA^{[2]}</script>. Turns out that this derivative is simply:</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-81-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1017" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1018" class="mjx-mrow"><span id="MJXc-Node-1019" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1020" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1021" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1022" class="mjx-texatom" style=""><span id="MJXc-Node-1023" class="mjx-mrow"><span id="MJXc-Node-1024" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1025" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1026" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1027" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-1028" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-1029" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">−</span></span><span id="MJXc-Node-1030" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1031" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1032" class="mjx-texatom" style=""><span id="MJXc-Node-1033" class="mjx-mrow"><span id="MJXc-Node-1034" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1035" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1036" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>d</mi><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><mi>Y</mi><mo>−</mo><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-81">dA^{[2]} = Y - A^{[2]}</script>

<p>If you know calculus, you can take the derivative of the loss function and confirm this for yourself. (Hint: <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-82-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1037" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1038" class="mjx-mrow"><span id="MJXc-Node-1039" class="mjx-texatom"><span id="MJXc-Node-1040" class="mjx-mrow"><span id="MJXc-Node-1041" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.083em;"><span id="MJXc-Node-1043" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.315em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-1042" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.493em; padding-right: 0.006em;">y</span></span></span></span></span></span></span><span id="MJXc-Node-1044" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-1045" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-1046" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1047" class="mjx-texatom" style=""><span id="MJXc-Node-1048" class="mjx-mrow"><span id="MJXc-Node-1049" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1050" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1051" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mo>=</mo><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-82">\hat{y} = A^{[2]}</script>)</p>

<p>From <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-83-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1052" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1053" class="mjx-mrow"><span id="MJXc-Node-1054" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1055" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1056" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1057" class="mjx-texatom" style=""><span id="MJXc-Node-1058" class="mjx-mrow"><span id="MJXc-Node-1059" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1060" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1061" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-83">dA^{[2]}</script>, we can calculate <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-84-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1062" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1063" class="mjx-mrow"><span id="MJXc-Node-1064" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1065" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1066" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1067" class="mjx-texatom" style=""><span id="MJXc-Node-1068" class="mjx-mrow"><span id="MJXc-Node-1069" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1070" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1071" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-84">dW^{[2]}</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-85-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1072" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1073" class="mjx-mrow"><span id="MJXc-Node-1074" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1075" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1076" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1077" class="mjx-texatom" style=""><span id="MJXc-Node-1078" class="mjx-mrow"><span id="MJXc-Node-1079" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1080" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1081" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-85">db^{[1]}</script>:</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-86-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; min-width: 9.206em; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1082" class="mjx-math" style="width: 100%;" aria-hidden="true"><span id="MJXc-Node-1083" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -2.531em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-1084" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1085" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1086" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1087" class="mjx-texatom" style=""><span id="MJXc-Node-1088" class="mjx-mrow"><span id="MJXc-Node-1089" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1090" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1091" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1092" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-1093" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.078em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.078em; top: -1.368em;"><span id="MJXc-Node-1094" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span></span><span class="mjx-denominator" style="width: 1.078em; bottom: -0.722em;"><span id="MJXc-Node-1095" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">m</span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.078em;"></span></span><span class="mjx-vsize" style="height: 2.089em; vertical-align: -0.722em;"></span></span><span id="MJXc-Node-1096" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1097" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1098" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1099" class="mjx-texatom" style=""><span id="MJXc-Node-1100" class="mjx-mrow"><span id="MJXc-Node-1101" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1102" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1103" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1104" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1105" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1106" class="mjx-texatom" style=""><span id="MJXc-Node-1107" class="mjx-mrow"><span id="MJXc-Node-1108" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1109" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1110" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span><span id="MJXc-Node-1111" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.12em;">T</span></span></span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1112" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-1113" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1114" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1115" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em;">B</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1116" class="mjx-texatom" style=""><span id="MJXc-Node-1117" class="mjx-mrow"><span id="MJXc-Node-1118" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1119" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1120" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1121" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-1122" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.078em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.078em; top: -1.368em;"><span id="MJXc-Node-1123" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span></span><span class="mjx-denominator" style="width: 1.078em; bottom: -0.722em;"><span id="MJXc-Node-1124" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">m</span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.078em;"></span></span><span class="mjx-vsize" style="height: 2.089em; vertical-align: -0.722em;"></span></span><span id="MJXc-Node-1125" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.359em;">Σ</span></span><span id="MJXc-Node-1126" class="mjx-texatom"><span id="MJXc-Node-1127" class="mjx-mrow"><span id="MJXc-Node-1128" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1129" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1130" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1131" class="mjx-texatom" style=""><span id="MJXc-Node-1132" class="mjx-mrow"><span id="MJXc-Node-1133" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1134" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1135" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>d</mi><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mi>d</mi><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mi>T</mi></mrow></msup><mspace linebreak="newline"></mspace><mi>d</mi><msup><mi>B</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-86">dW^{[2]} = \frac{1}{m} dZ^{[2]} A^{[1]T} \\
dB^{[2]} = \frac{1}{m} \Sigma {dZ^{[2]}}</script>

<p>Then, to calculate <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-87-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1136" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1137" class="mjx-mrow"><span id="MJXc-Node-1138" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1139" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1140" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1141" class="mjx-texatom" style=""><span id="MJXc-Node-1142" class="mjx-mrow"><span id="MJXc-Node-1143" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1144" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1145" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-87">dW^{[1]}</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-88-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1146" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1147" class="mjx-mrow"><span id="MJXc-Node-1148" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1149" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1150" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1151" class="mjx-texatom" style=""><span id="MJXc-Node-1152" class="mjx-mrow"><span id="MJXc-Node-1153" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1154" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1155" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-88">db^{[1]}</script>, we’ll first find <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-89-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1156" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1157" class="mjx-mrow"><span id="MJXc-Node-1158" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1159" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1160" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1161" class="mjx-texatom" style=""><span id="MJXc-Node-1162" class="mjx-mrow"><span id="MJXc-Node-1163" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1164" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1165" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-89">dZ^{[1]}</script>:</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-90-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi class=&quot;MJX-variant&quot; mathvariant=&quot;normal&quot;&gt;&amp;#x2032;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1166" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1167" class="mjx-mrow"><span id="MJXc-Node-1168" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1169" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1170" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1171" class="mjx-texatom" style=""><span id="MJXc-Node-1172" class="mjx-mrow"><span id="MJXc-Node-1173" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1174" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1175" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1176" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-1177" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1178" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1179" class="mjx-texatom" style=""><span id="MJXc-Node-1180" class="mjx-mrow"><span id="MJXc-Node-1181" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1182" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1183" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span><span id="MJXc-Node-1184" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.12em;">T</span></span></span></span></span></span><span id="MJXc-Node-1185" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1186" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1187" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1188" class="mjx-texatom" style=""><span id="MJXc-Node-1189" class="mjx-mrow"><span id="MJXc-Node-1190" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1191" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1192" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1193" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.176em; padding-bottom: 0.359em;">.</span></span><span id="MJXc-Node-1194" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.181em; padding-bottom: 0.315em;">∗</span></span><span id="MJXc-Node-1195" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-1196" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.493em; padding-right: 0.003em;">g</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.076em; padding-right: 0.071em;"><span id="MJXc-Node-1197" class="mjx-texatom" style=""><span id="MJXc-Node-1198" class="mjx-mrow"><span id="MJXc-Node-1199" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1200" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1201" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span><span id="MJXc-Node-1202" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.27em; padding-bottom: 0.315em;">′</span></span></span></span></span></span><span id="MJXc-Node-1203" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">(</span></span><span id="MJXc-Node-1204" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1205" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1206" class="mjx-texatom" style=""><span id="MJXc-Node-1207" class="mjx-mrow"><span id="MJXc-Node-1208" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1209" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1210" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1211" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>d</mi><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mi>T</mi></mrow></msup><mi>d</mi><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>.</mo><mo>∗</mo><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mi class="MJX-variant" mathvariant="normal">′</mi></mrow></msup><mo stretchy="false">(</mo><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-90">dZ^{[1]} = W^{[2]T} dZ^{[2]} .* g^{[1]\prime} (Z^{[1]})</script>

<p>I won’t explain all the details of the math, but you can get some intuitive hints at what’s going on here by just looking at the variables. We’re applying <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-91-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1212" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1213" class="mjx-mrow"><span id="MJXc-Node-1214" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1215" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1216" class="mjx-texatom" style=""><span id="MJXc-Node-1217" class="mjx-mrow"><span id="MJXc-Node-1218" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1219" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1220" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span><span id="MJXc-Node-1221" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.12em;">T</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mi>T</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-91">W^{[2]T}</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-92-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1222" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1223" class="mjx-mrow"><span id="MJXc-Node-1224" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1225" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1226" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1227" class="mjx-texatom" style=""><span id="MJXc-Node-1228" class="mjx-mrow"><span id="MJXc-Node-1229" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1230" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1231" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-92">dZ^{[2]}</script>, akin to applying the weights between layers 1 and 2 in reverse. Then, we perform an element-wise multiplication with the derivative of the activation function, akin to “undoing” it to get the correct error values.</p>

<p>Since our activation function is ReLU, our derivative is actually pretty simple. Let’s revisit our graph:</p>

<p><img src="./Understanding_files/nn3.png" alt=""></p>

<p>When the input value is greater than 0, the activation function is linear with a derivative of 1. When the input value is less than 0, the activation function is horizontal with a derivative of 0. Thus, <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-93-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi class=&quot;MJX-variant&quot; mathvariant=&quot;normal&quot;&gt;&amp;#x2032;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1232" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1233" class="mjx-mrow"><span id="MJXc-Node-1234" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-1235" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.493em; padding-right: 0.003em;">g</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.076em; padding-right: 0.071em;"><span id="MJXc-Node-1236" class="mjx-texatom" style=""><span id="MJXc-Node-1237" class="mjx-mrow"><span id="MJXc-Node-1238" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1239" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1240" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span><span id="MJXc-Node-1241" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.27em; padding-bottom: 0.315em;">′</span></span></span></span></span></span><span id="MJXc-Node-1242" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">(</span></span><span id="MJXc-Node-1243" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1244" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1245" class="mjx-texatom" style=""><span id="MJXc-Node-1246" class="mjx-mrow"><span id="MJXc-Node-1247" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1248" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1249" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1250" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mi class="MJX-variant" mathvariant="normal">′</mi></mrow></msup><mo stretchy="false">(</mo><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-93">g^{[1]\prime}(Z^{[1]})</script> is just a matrix of 1s and 0s based on values of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-94-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1251" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1252" class="mjx-mrow"><span id="MJXc-Node-1253" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1254" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1255" class="mjx-texatom" style=""><span id="MJXc-Node-1256" class="mjx-mrow"><span id="MJXc-Node-1257" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1258" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1259" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-94">Z^{[1]}</script>.</p>

<p>From here, we do the same calculations as earlier to find <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-95-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1260" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1261" class="mjx-mrow"><span id="MJXc-Node-1262" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1263" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1264" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1265" class="mjx-texatom" style=""><span id="MJXc-Node-1266" class="mjx-mrow"><span id="MJXc-Node-1267" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1268" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1269" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-95">dW^{[1]}</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-96-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1270" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1271" class="mjx-mrow"><span id="MJXc-Node-1272" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1273" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1274" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1275" class="mjx-texatom" style=""><span id="MJXc-Node-1276" class="mjx-mrow"><span id="MJXc-Node-1277" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1278" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1279" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-96">db^{[1]}</script>, using <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-97-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1280" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1281" class="mjx-mrow"><span id="MJXc-Node-1282" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-97">X</script> in place of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-98-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1283" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1284" class="mjx-mrow"><span id="MJXc-Node-1285" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1286" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1287" class="mjx-texatom" style=""><span id="MJXc-Node-1288" class="mjx-mrow"><span id="MJXc-Node-1289" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1290" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1291" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-98">A^{[1]}</script>:</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-99-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; min-width: 8.618em; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1292" class="mjx-math" style="width: 100%;" aria-hidden="true"><span id="MJXc-Node-1293" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -2.531em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-1294" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1295" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1296" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1297" class="mjx-texatom" style=""><span id="MJXc-Node-1298" class="mjx-mrow"><span id="MJXc-Node-1299" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1300" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1301" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1302" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-1303" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.078em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.078em; top: -1.368em;"><span id="MJXc-Node-1304" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span></span><span class="mjx-denominator" style="width: 1.078em; bottom: -0.722em;"><span id="MJXc-Node-1305" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">m</span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.078em;"></span></span><span class="mjx-vsize" style="height: 2.089em; vertical-align: -0.722em;"></span></span><span id="MJXc-Node-1306" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1307" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1308" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1309" class="mjx-texatom" style=""><span id="MJXc-Node-1310" class="mjx-mrow"><span id="MJXc-Node-1311" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1312" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1313" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1314" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.024em;"><span id="MJXc-Node-1315" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.024em;">X</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.115em; padding-right: 0.071em;"><span id="MJXc-Node-1316" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.12em;">T</span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1317" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-1318" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1319" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1320" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em;">B</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1321" class="mjx-texatom" style=""><span id="MJXc-Node-1322" class="mjx-mrow"><span id="MJXc-Node-1323" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1324" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1325" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1326" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-1327" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.078em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.078em; top: -1.368em;"><span id="MJXc-Node-1328" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span></span><span class="mjx-denominator" style="width: 1.078em; bottom: -0.722em;"><span id="MJXc-Node-1329" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">m</span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.078em;"></span></span><span class="mjx-vsize" style="height: 2.089em; vertical-align: -0.722em;"></span></span><span id="MJXc-Node-1330" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.359em;">Σ</span></span><span id="MJXc-Node-1331" class="mjx-texatom"><span id="MJXc-Node-1332" class="mjx-mrow"><span id="MJXc-Node-1333" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1334" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1335" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1336" class="mjx-texatom" style=""><span id="MJXc-Node-1337" class="mjx-mrow"><span id="MJXc-Node-1338" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1339" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1340" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>d</mi><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mi>d</mi><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><msup><mi>X</mi><mi>T</mi></msup><mspace linebreak="newline"></mspace><mi>d</mi><msup><mi>B</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-99">dW^{[1]} = \frac{1}{m} dZ^{[1]} X^T \\
dB^{[1]} = \frac{1}{m} \Sigma {dZ^{[1]}}</script>

<p>Now we’ve found all the derivatives we need, and all that’s left is to update our parameters:</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-100-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; min-width: 9.731em; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;:=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;:=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;:=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;:=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1341" class="mjx-math" style="width: 100%;" aria-hidden="true"><span id="MJXc-Node-1342" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -4.53em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-1343" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1344" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1345" class="mjx-texatom" style=""><span id="MJXc-Node-1346" class="mjx-mrow"><span id="MJXc-Node-1347" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1348" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1349" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1350" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.359em;">:<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">=</span></span></span><span id="MJXc-Node-1351" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1352" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1353" class="mjx-texatom" style=""><span id="MJXc-Node-1354" class="mjx-mrow"><span id="MJXc-Node-1355" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1356" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1357" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1358" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">−</span></span><span id="MJXc-Node-1359" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">α</span></span><span id="MJXc-Node-1360" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1361" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1362" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1363" class="mjx-texatom" style=""><span id="MJXc-Node-1364" class="mjx-mrow"><span id="MJXc-Node-1365" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1366" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1367" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1368" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-1369" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1370" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1371" class="mjx-texatom" style=""><span id="MJXc-Node-1372" class="mjx-mrow"><span id="MJXc-Node-1373" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1374" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1375" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1376" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.359em;">:<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">=</span></span></span><span id="MJXc-Node-1377" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-1378" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1379" class="mjx-texatom" style=""><span id="MJXc-Node-1380" class="mjx-mrow"><span id="MJXc-Node-1381" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1382" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1383" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1384" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">−</span></span><span id="MJXc-Node-1385" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">α</span></span><span id="MJXc-Node-1386" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1387" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1388" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1389" class="mjx-texatom" style=""><span id="MJXc-Node-1390" class="mjx-mrow"><span id="MJXc-Node-1391" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1392" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1393" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1394" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-1395" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1396" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1397" class="mjx-texatom" style=""><span id="MJXc-Node-1398" class="mjx-mrow"><span id="MJXc-Node-1399" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1400" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1401" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1402" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.359em;">:<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">=</span></span></span><span id="MJXc-Node-1403" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1404" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1405" class="mjx-texatom" style=""><span id="MJXc-Node-1406" class="mjx-mrow"><span id="MJXc-Node-1407" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1408" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1409" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1410" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">−</span></span><span id="MJXc-Node-1411" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">α</span></span><span id="MJXc-Node-1412" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1413" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1414" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1415" class="mjx-texatom" style=""><span id="MJXc-Node-1416" class="mjx-mrow"><span id="MJXc-Node-1417" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1418" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1419" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1420" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-1421" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1422" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1423" class="mjx-texatom" style=""><span id="MJXc-Node-1424" class="mjx-mrow"><span id="MJXc-Node-1425" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1426" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1427" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1428" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.359em;">:<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">=</span></span></span><span id="MJXc-Node-1429" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-1430" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1431" class="mjx-texatom" style=""><span id="MJXc-Node-1432" class="mjx-mrow"><span id="MJXc-Node-1433" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1434" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1435" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1436" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">−</span></span><span id="MJXc-Node-1437" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">α</span></span><span id="MJXc-Node-1438" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1439" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1440" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1441" class="mjx-texatom" style=""><span id="MJXc-Node-1442" class="mjx-mrow"><span id="MJXc-Node-1443" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1444" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1445" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>:=</mo><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>−</mo><mi>α</mi><mi>d</mi><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mspace linebreak="newline"></mspace><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>:=</mo><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>−</mo><mi>α</mi><mi>d</mi><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mspace linebreak="newline"></mspace><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>:=</mo><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>−</mo><mi>α</mi><mi>d</mi><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mspace linebreak="newline"></mspace><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>:=</mo><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>−</mo><mi>α</mi><mi>d</mi><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-100">W^{[2]} := W^{[2]} - \alpha dW^{[2]} \\ b^{[2]} := b^{[2]} - \alpha db^{[2]} \\ W^{[1]} := W^{[1]} - \alpha dW^{[1]} \\ b^{[1]} := b^{[1]} - \alpha db^{[1]}</script>

<p>Here, <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-101-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1446" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1447" class="mjx-mrow"><span id="MJXc-Node-1448" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">α</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi></math></span></span><script type="math/tex" id="MathJax-Element-101">\alpha</script>is our learning rate, a “hyperparameter” that we set to whatever we want. <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-102-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1449" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1450" class="mjx-mrow"><span id="MJXc-Node-1451" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">α</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi></math></span></span><script type="math/tex" id="MathJax-Element-102">\alpha</script> is distinguished from other parameters because, just like the number of layers in the network or the number of units in each layer, it’s a value that we choose for our model rather than one that gradient descent optimizes.</p>

<p>With that, we’ve gone over all the math that we need to carry out gradient descent and train our neural network. To recap: first, we carry out forward propagation, getting a prediction from an input image:</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-103-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; min-width: 8.777em; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;ReLU&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;softmax&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1452" class="mjx-math" style="width: 100%;" aria-hidden="true"><span id="MJXc-Node-1453" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -4.698em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-1454" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1455" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1456" class="mjx-texatom" style=""><span id="MJXc-Node-1457" class="mjx-mrow"><span id="MJXc-Node-1458" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1459" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1460" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1461" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-1462" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1463" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1464" class="mjx-texatom" style=""><span id="MJXc-Node-1465" class="mjx-mrow"><span id="MJXc-Node-1466" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1467" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1468" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1469" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1470" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">+</span></span><span id="MJXc-Node-1471" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1472" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1473" class="mjx-texatom" style=""><span id="MJXc-Node-1474" class="mjx-mrow"><span id="MJXc-Node-1475" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1476" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1477" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1478" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-1479" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1480" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1481" class="mjx-texatom" style=""><span id="MJXc-Node-1482" class="mjx-mrow"><span id="MJXc-Node-1483" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1484" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1485" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1486" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-1487" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-1488" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.493em; padding-right: 0.003em;">g</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1489" class="mjx-texatom" style=""><span id="MJXc-Node-1490" class="mjx-mrow"><span id="MJXc-Node-1491" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.359em;">ReLU</span></span></span></span></span></span><span id="MJXc-Node-1492" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">(</span></span><span id="MJXc-Node-1493" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1494" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1495" class="mjx-texatom" style=""><span id="MJXc-Node-1496" class="mjx-mrow"><span id="MJXc-Node-1497" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1498" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1499" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1500" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">)</span></span><span id="MJXc-Node-1501" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">)</span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1502" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-1503" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1504" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1505" class="mjx-texatom" style=""><span id="MJXc-Node-1506" class="mjx-mrow"><span id="MJXc-Node-1507" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1508" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1509" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1510" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-1511" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1512" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1513" class="mjx-texatom" style=""><span id="MJXc-Node-1514" class="mjx-mrow"><span id="MJXc-Node-1515" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1516" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1517" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1518" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1519" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1520" class="mjx-texatom" style=""><span id="MJXc-Node-1521" class="mjx-mrow"><span id="MJXc-Node-1522" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1523" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1524" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1525" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">+</span></span><span id="MJXc-Node-1526" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1527" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1528" class="mjx-texatom" style=""><span id="MJXc-Node-1529" class="mjx-mrow"><span id="MJXc-Node-1530" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1531" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1532" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1533" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-1534" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1535" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1536" class="mjx-texatom" style=""><span id="MJXc-Node-1537" class="mjx-mrow"><span id="MJXc-Node-1538" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1539" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1540" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1541" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-1542" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-1543" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.493em; padding-right: 0.003em;">g</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-1544" class="mjx-texatom" style=""><span id="MJXc-Node-1545" class="mjx-mrow"><span id="MJXc-Node-1546" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.359em;">softmax</span></span></span></span></span></span><span id="MJXc-Node-1547" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">(</span></span><span id="MJXc-Node-1548" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1549" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1550" class="mjx-texatom" style=""><span id="MJXc-Node-1551" class="mjx-mrow"><span id="MJXc-Node-1552" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1553" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1554" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1555" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">)</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mi>X</mi><mo>+</mo><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mspace linebreak="newline"></mspace><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mtext>ReLU</mtext></mrow></msub><mo stretchy="false">(</mo><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>+</mo><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mspace linebreak="newline"></mspace><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mtext>softmax</mtext></mrow></msub><mo stretchy="false">(</mo><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-103">Z^{[1]} = W^{[1]} X + b^{[1]}\\A^{[1]} = g_{\text{ReLU}}(Z^{[1]}))\\Z^{[2]} = W^{[2]} A^{[1]} + b^{[2]}\\A^{[2]} = g_{\text{softmax}}(Z^{[2]})</script>

<p>Then, we carry out backprop to compute loss function derivatives:</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-104-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; min-width: 12.454em; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi class=&quot;MJX-variant&quot; mathvariant=&quot;normal&quot;&gt;&amp;#x2032;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1556" class="mjx-math" style="width: 100%;" aria-hidden="true"><span id="MJXc-Node-1557" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -11.189em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-1558" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1559" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1560" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1561" class="mjx-texatom" style=""><span id="MJXc-Node-1562" class="mjx-mrow"><span id="MJXc-Node-1563" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1564" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1565" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1566" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-1567" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-1568" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1569" class="mjx-texatom" style=""><span id="MJXc-Node-1570" class="mjx-mrow"><span id="MJXc-Node-1571" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1572" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1573" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1574" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">−</span></span><span id="MJXc-Node-1575" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.182em;">Y</span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1576" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-1577" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1578" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1579" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1580" class="mjx-texatom" style=""><span id="MJXc-Node-1581" class="mjx-mrow"><span id="MJXc-Node-1582" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1583" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1584" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1585" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-1586" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.078em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.078em; top: -1.368em;"><span id="MJXc-Node-1587" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span></span><span class="mjx-denominator" style="width: 1.078em; bottom: -0.722em;"><span id="MJXc-Node-1588" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">m</span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.078em;"></span></span><span class="mjx-vsize" style="height: 2.089em; vertical-align: -0.722em;"></span></span><span id="MJXc-Node-1589" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1590" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1591" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1592" class="mjx-texatom" style=""><span id="MJXc-Node-1593" class="mjx-mrow"><span id="MJXc-Node-1594" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1595" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1596" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1597" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1598" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1599" class="mjx-texatom" style=""><span id="MJXc-Node-1600" class="mjx-mrow"><span id="MJXc-Node-1601" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1602" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1603" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span><span id="MJXc-Node-1604" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.12em;">T</span></span></span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1605" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-1606" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1607" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1608" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em;">B</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1609" class="mjx-texatom" style=""><span id="MJXc-Node-1610" class="mjx-mrow"><span id="MJXc-Node-1611" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1612" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1613" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1614" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-1615" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.078em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.078em; top: -1.368em;"><span id="MJXc-Node-1616" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span></span><span class="mjx-denominator" style="width: 1.078em; bottom: -0.722em;"><span id="MJXc-Node-1617" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">m</span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.078em;"></span></span><span class="mjx-vsize" style="height: 2.089em; vertical-align: -0.722em;"></span></span><span id="MJXc-Node-1618" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.359em;">Σ</span></span><span id="MJXc-Node-1619" class="mjx-texatom"><span id="MJXc-Node-1620" class="mjx-mrow"><span id="MJXc-Node-1621" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1622" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1623" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1624" class="mjx-texatom" style=""><span id="MJXc-Node-1625" class="mjx-mrow"><span id="MJXc-Node-1626" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1627" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1628" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1629" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-1630" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1631" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1632" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1633" class="mjx-texatom" style=""><span id="MJXc-Node-1634" class="mjx-mrow"><span id="MJXc-Node-1635" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1636" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1637" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1638" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-1639" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1640" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1641" class="mjx-texatom" style=""><span id="MJXc-Node-1642" class="mjx-mrow"><span id="MJXc-Node-1643" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1644" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1645" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span><span id="MJXc-Node-1646" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.12em;">T</span></span></span></span></span></span><span id="MJXc-Node-1647" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1648" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1649" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1650" class="mjx-texatom" style=""><span id="MJXc-Node-1651" class="mjx-mrow"><span id="MJXc-Node-1652" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1653" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1654" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1655" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.176em; padding-bottom: 0.359em;">.</span></span><span id="MJXc-Node-1656" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.181em; padding-bottom: 0.315em;">∗</span></span><span id="MJXc-Node-1657" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-1658" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.493em; padding-right: 0.003em;">g</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.076em; padding-right: 0.071em;"><span id="MJXc-Node-1659" class="mjx-texatom" style=""><span id="MJXc-Node-1660" class="mjx-mrow"><span id="MJXc-Node-1661" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1662" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1663" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span><span id="MJXc-Node-1664" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.27em; padding-bottom: 0.315em;">′</span></span></span></span></span></span><span id="MJXc-Node-1665" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">(</span></span><span id="MJXc-Node-1666" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-1667" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em; padding-right: 0.003em;">z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.076em; padding-right: 0.071em;"><span id="MJXc-Node-1668" class="mjx-texatom" style=""><span id="MJXc-Node-1669" class="mjx-mrow"><span id="MJXc-Node-1670" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1671" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1672" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1673" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">)</span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1674" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-1675" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1676" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1677" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1678" class="mjx-texatom" style=""><span id="MJXc-Node-1679" class="mjx-mrow"><span id="MJXc-Node-1680" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1681" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1682" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1683" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-1684" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.078em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.078em; top: -1.368em;"><span id="MJXc-Node-1685" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span></span><span class="mjx-denominator" style="width: 1.078em; bottom: -0.722em;"><span id="MJXc-Node-1686" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">m</span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.078em;"></span></span><span class="mjx-vsize" style="height: 2.089em; vertical-align: -0.722em;"></span></span><span id="MJXc-Node-1687" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1688" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1689" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1690" class="mjx-texatom" style=""><span id="MJXc-Node-1691" class="mjx-mrow"><span id="MJXc-Node-1692" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1693" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1694" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1695" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1696" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">A</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1697" class="mjx-texatom" style=""><span id="MJXc-Node-1698" class="mjx-mrow"><span id="MJXc-Node-1699" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1700" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">0</span></span><span id="MJXc-Node-1701" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span><span id="MJXc-Node-1702" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.12em;">T</span></span></span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1703" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-1704" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1705" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1706" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em;">B</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1707" class="mjx-texatom" style=""><span id="MJXc-Node-1708" class="mjx-mrow"><span id="MJXc-Node-1709" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1710" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1711" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1712" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.315em;">=</span></span><span id="MJXc-Node-1713" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.078em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.078em; top: -1.368em;"><span id="MJXc-Node-1714" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span></span><span class="mjx-denominator" style="width: 1.078em; bottom: -0.722em;"><span id="MJXc-Node-1715" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">m</span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.078em;"></span></span><span class="mjx-vsize" style="height: 2.089em; vertical-align: -0.722em;"></span></span><span id="MJXc-Node-1716" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.404em; padding-bottom: 0.359em;">Σ</span></span><span id="MJXc-Node-1717" class="mjx-texatom"><span id="MJXc-Node-1718" class="mjx-mrow"><span id="MJXc-Node-1719" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1720" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.04em;"><span id="MJXc-Node-1721" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.04em;">Z</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.144em; padding-right: 0.071em;"><span id="MJXc-Node-1722" class="mjx-texatom" style=""><span id="MJXc-Node-1723" class="mjx-mrow"><span id="MJXc-Node-1724" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1725" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1726" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>d</mi><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>−</mo><mi>Y</mi><mspace linebreak="newline"></mspace><mi>d</mi><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mi>d</mi><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mi>T</mi></mrow></msup><mspace linebreak="newline"></mspace><mi>d</mi><msup><mi>B</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></mrow><mspace linebreak="newline"></mspace><mi>d</mi><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mi>T</mi></mrow></msup><mi>d</mi><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>.</mo><mo>∗</mo><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mi class="MJX-variant" mathvariant="normal">′</mi></mrow></msup><mo stretchy="false">(</mo><msup><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>d</mi><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mi>d</mi><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mi>T</mi></mrow></msup><mspace linebreak="newline"></mspace><mi>d</mi><msup><mi>B</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><msup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-104">dZ^{[2]} = A^{[2]} - Y\\dW^{[2]} = \frac{1}{m} dZ^{[2]} A^{[1]T}\\dB^{[2]} = \frac{1}{m} \Sigma {dZ^{[2]}}\\dZ^{[1]} = W^{[2]T} dZ^{[2]} .* g^{[1]\prime} (z^{[1]})\\dW^{[1]} = \frac{1}{m} dZ^{[1]} A^{[0]T}\\dB^{[1]} = \frac{1}{m} \Sigma {dZ^{[1]}}</script>

<p>Finally, we update our parameters accordingly:</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-105-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 112%; min-width: 9.731em; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;:=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;:=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;:=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;:=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1727" class="mjx-math" style="width: 100%;" aria-hidden="true"><span id="MJXc-Node-1728" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -4.53em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-1729" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1730" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1731" class="mjx-texatom" style=""><span id="MJXc-Node-1732" class="mjx-mrow"><span id="MJXc-Node-1733" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1734" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1735" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1736" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.359em;">:<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">=</span></span></span><span id="MJXc-Node-1737" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1738" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1739" class="mjx-texatom" style=""><span id="MJXc-Node-1740" class="mjx-mrow"><span id="MJXc-Node-1741" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1742" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1743" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1744" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">−</span></span><span id="MJXc-Node-1745" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">α</span></span><span id="MJXc-Node-1746" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1747" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1748" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1749" class="mjx-texatom" style=""><span id="MJXc-Node-1750" class="mjx-mrow"><span id="MJXc-Node-1751" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1752" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1753" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1754" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-1755" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1756" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1757" class="mjx-texatom" style=""><span id="MJXc-Node-1758" class="mjx-mrow"><span id="MJXc-Node-1759" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1760" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1761" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1762" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.359em;">:<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">=</span></span></span><span id="MJXc-Node-1763" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-1764" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1765" class="mjx-texatom" style=""><span id="MJXc-Node-1766" class="mjx-mrow"><span id="MJXc-Node-1767" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1768" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1769" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1770" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">−</span></span><span id="MJXc-Node-1771" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">α</span></span><span id="MJXc-Node-1772" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1773" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1774" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1775" class="mjx-texatom" style=""><span id="MJXc-Node-1776" class="mjx-mrow"><span id="MJXc-Node-1777" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1778" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">2</span></span><span id="MJXc-Node-1779" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1780" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-1781" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1782" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1783" class="mjx-texatom" style=""><span id="MJXc-Node-1784" class="mjx-mrow"><span id="MJXc-Node-1785" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1786" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1787" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1788" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.359em;">:<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">=</span></span></span><span id="MJXc-Node-1789" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1790" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1791" class="mjx-texatom" style=""><span id="MJXc-Node-1792" class="mjx-mrow"><span id="MJXc-Node-1793" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1794" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1795" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1796" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">−</span></span><span id="MJXc-Node-1797" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">α</span></span><span id="MJXc-Node-1798" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1799" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-1800" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.315em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-1801" class="mjx-texatom" style=""><span id="MJXc-Node-1802" class="mjx-mrow"><span id="MJXc-Node-1803" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1804" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1805" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-1806" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-1807" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1808" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1809" class="mjx-texatom" style=""><span id="MJXc-Node-1810" class="mjx-mrow"><span id="MJXc-Node-1811" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1812" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1813" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1814" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.092em; padding-bottom: 0.359em;">:<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">=</span></span></span><span id="MJXc-Node-1815" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-1816" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1817" class="mjx-texatom" style=""><span id="MJXc-Node-1818" class="mjx-mrow"><span id="MJXc-Node-1819" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1820" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1821" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span><span id="MJXc-Node-1822" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.315em; padding-bottom: 0.404em;">−</span></span><span id="MJXc-Node-1823" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.27em;">α</span></span><span id="MJXc-Node-1824" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1825" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1826" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.493em; padding-bottom: 0.27em;">b</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1827" class="mjx-texatom" style=""><span id="MJXc-Node-1828" class="mjx-mrow"><span id="MJXc-Node-1829" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">[</span></span><span id="MJXc-Node-1830" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.359em; padding-bottom: 0.359em;">1</span></span><span id="MJXc-Node-1831" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.449em; padding-bottom: 0.583em;">]</span></span></span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>:=</mo><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>−</mo><mi>α</mi><mi>d</mi><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mspace linebreak="newline"></mspace><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>:=</mo><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>−</mo><mi>α</mi><mi>d</mi><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mspace linebreak="newline"></mspace><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>:=</mo><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>−</mo><mi>α</mi><mi>d</mi><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mspace linebreak="newline"></mspace><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>:=</mo><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>−</mo><mi>α</mi><mi>d</mi><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-105">W^{[2]} := W^{[2]} - \alpha dW^{[2]} \\ b^{[2]} := b^{[2]} - \alpha db^{[2]} \\ W^{[1]} := W^{[1]} - \alpha dW^{[1]} \\ b^{[1]} := b^{[1]} - \alpha db^{[1]}</script>

<p>We’ll do this process over and over again — the exact number of times, an iteration count that we again set ourselves — until we are satisfied with the performance of our model.</p>

<h2 id="the-code">The code</h2>

<p>With all the math out of the way, all that’s left is to implement our neural network in code. I did so in a Python Jupyter notebook hosted on Kaggle — you can see all my code here: <a href="https://web.archive.org/web/20210423082804/https://www.kaggle.com/wwsalmon/simple-mnist-nn-from-scratch-numpy-no-tf-keras">https://www.kaggle.com/wwsalmon/simple-mnist-nn-from-scratch-numpy-no-tf-keras</a></p>

<p>First, we’ll import numpy to help us manipulate our data matrices and carry out linear algebra operations. (In the Kaggle notebook I also import pandas to help with reading in data and matplotlib to display images).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
</code></pre></div></div>

<p>We’ll then initialize our parameters to matrices of small, random values of the correct shape:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">init_params</span><span class="p">():</span>
    <span class="n">W1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">784</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
    <span class="n">W2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
    <span class="n">b2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
    <span class="k">return</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span>
</code></pre></div></div>

<p>With parameters and matrix <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-106-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 112%; position: relative;"><span id="MJXc-Node-1832" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1833" class="mjx-mrow"><span id="MJXc-Node-1834" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.449em; padding-bottom: 0.27em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-106">X</script>as input, we can write a function to carry out forward propagation:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">forward_prop</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
    <span class="n">Z1</span> <span class="o">=</span> <span class="n">W1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="n">b1</span>
    <span class="n">A1</span> <span class="o">=</span> <span class="n">ReLU</span><span class="p">(</span><span class="n">Z1</span><span class="p">)</span>
    <span class="n">Z2</span> <span class="o">=</span> <span class="n">W2</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A1</span><span class="p">)</span> <span class="o">+</span> <span class="n">b2</span>
    <span class="n">A2</span> <span class="o">=</span> <span class="n">softmax</span><span class="p">(</span><span class="n">Z2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Z1</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">A2</span>
</code></pre></div></div>

<p>We’ll need to fill in two helper functions here for our two activation functions:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">ReLU</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">softmax</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Z</span><span class="p">))</span>
</code></pre></div></div>

<p>Notice that we returned not just our final predictions but also Z1, A2, and Z2 from our forward prop function. This is because we’ll now pass them into a backprop function:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">backward_prop</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="n">one_hot_Y</span> <span class="o">=</span> <span class="n">one_hot</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">dZ2</span> <span class="o">=</span> <span class="n">A2</span> <span class="o">-</span> <span class="n">one_hot_Y</span>
    <span class="n">dW2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">m</span> <span class="o">*</span> <span class="n">dZ2</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A1</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">db2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">m</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">dZ2</span><span class="p">)</span>
    <span class="n">dZ1</span> <span class="o">=</span> <span class="n">W2</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dZ2</span><span class="p">)</span> <span class="o">*</span> <span class="n">ReLU_deriv</span><span class="p">(</span><span class="n">Z1</span><span class="p">)</span>
    <span class="n">dW1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">m</span> <span class="o">*</span> <span class="n">dZ1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">db1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">m</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">dZ1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dW1</span><span class="p">,</span> <span class="n">db1</span><span class="p">,</span> <span class="n">dW2</span><span class="p">,</span> <span class="n">db2</span>
</code></pre></div></div>

<p>Again, we’ll need some helper functions for the derivative of our ReLU activation function and for one-hot encoding of our labels Y:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">ReLU_deriv</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Z</span> <span class="o">&gt;</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">one_hot</span><span class="p">(</span><span class="n">Y</span><span class="p">):</span>
    <span class="n">one_hot_Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Y</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">Y</span><span class="o">.</span><span class="nb">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">one_hot_Y</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">Y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">one_hot_Y</span> <span class="o">=</span> <span class="n">one_hot_Y</span><span class="o">.</span><span class="n">T</span>
    <span class="k">return</span> <span class="n">one_hot_Y</span>
</code></pre></div></div>

<p>Finally, once we have our derivative values, we complete gradient descent by updating our parameters.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">update_params</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">dW1</span><span class="p">,</span> <span class="n">db1</span><span class="p">,</span> <span class="n">dW2</span><span class="p">,</span> <span class="n">db2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
    <span class="n">W1</span> <span class="o">=</span> <span class="n">W1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">dW1</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">db1</span>    
    <span class="n">W2</span> <span class="o">=</span> <span class="n">W2</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">dW2</span>  
    <span class="n">b2</span> <span class="o">=</span> <span class="n">b2</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">db2</span>    
    <span class="k">return</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span>
</code></pre></div></div>

<p>We’ll tie it all together with a for loop in a wrapper function, with another two helper functions for printing out the accuracy on every 10th iteration:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_predictions</span><span class="p">(</span><span class="n">A2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">A2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_accuracy</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">predictions</span> <span class="o">==</span> <span class="n">Y</span><span class="p">)</span> <span class="o">/</span> <span class="n">Y</span><span class="o">.</span><span class="n">size</span>

<span class="k">def</span> <span class="nf">gradient_descent</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">iterations</span><span class="p">):</span>
    <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span> <span class="o">=</span> <span class="n">init_params</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>
        <span class="n">Z1</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">A2</span> <span class="o">=</span> <span class="n">forward_prop</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
        <span class="n">dW1</span><span class="p">,</span> <span class="n">db1</span><span class="p">,</span> <span class="n">dW2</span><span class="p">,</span> <span class="n">db2</span> <span class="o">=</span> <span class="n">backward_prop</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
        <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span> <span class="o">=</span> <span class="n">update_params</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">dW1</span><span class="p">,</span> <span class="n">db1</span><span class="p">,</span> <span class="n">dW2</span><span class="p">,</span> <span class="n">db2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Iteration: "</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="n">get_predictions</span><span class="p">(</span><span class="n">A2</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">get_accuracy</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">Y</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span>
</code></pre></div></div>

<p>With that, we can run our <code class="highlighter-rouge">gradient_descent</code> function on our training X and Y data, as well as learning rate <code class="highlighter-rouge">alpha</code> and number of iterations <code class="highlighter-rouge">iterations</code>, to get trained parameters <code class="highlighter-rouge">W1</code>, <code class="highlighter-rouge">b1</code>, <code class="highlighter-rouge">W2</code>, and <code class="highlighter-rouge">b2</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span> <span class="o">=</span> <span class="n">gradient_descent</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
</code></pre></div></div>

<p>In the Kaggle notebook, with a training dataset of 41,000 examples, this model achieved an accuracy of 85% on the training data, and 84% on 1,000 examples set aside as test data.</p>

<p>A few prediction examples:</p>

<p><img src="./Understanding_files/nn5.png" alt=""></p>

<p><img src="./Understanding_files/nn6.png" alt=""></p>

<p><img src="./Understanding_files/nn7.png" alt=""></p>

<h2 id="conclusion">Conclusion</h2>

<p>And that’s it! We’ve run through all the math behind how a neural network works, and implemented it in Python, training a real model with an 84% accuracy when identifying handwritten images.</p>

<p>There are many ways that this model could be improved. The dataset is a fairly easy one to build a model for, with top solutions hitting above 99% accuracy. Even before considering fancy architectures like CNNs, just adding more hidden layers or units to our model would help it recognize patterns and make predictions more effectively.</p>

<p>There are many possible optimizations for the gradient descent process, too. Gradient descent with momentum, RMSProp, and Adam optimization are popular variations of gradient descent that improve training efficiency.</p>

<p>Of course, it doesn’t make sense to go out and code super-complex models yourself when frameworks like Tensorflow have already implemented them and tons of other optimizations and functionality. The purpose of this neural network from scratch project was to be instructive, providing an in-depth walkthrough not just of how a neural network works in theory, but into the intricacies of the math and code that make it tick. You’ll rarely use this knowledge directly in further machine learning application or learning, but at least to me, it’s a path to building a solid foundation from which more advanced exploration can launch.</p>

<p>I hope that some of you will find this article helpful! Once again, you can find the <a href="https://web.archive.org/web/20210423082804/https://www.kaggle.com/wwsalmon/simple-mnist-nn-from-scratch-numpy-no-tf-keras/">Kaggle notebook with all my code here</a>, and a <a href="https://web.archive.org/web/20210423082804/https://www.youtube.com/watch?v=w8yWXqWQYmU">video walkthrough of everything in this article here</a>.</p>

<p>If you want to follow along with my projects and learning, <a href="https://web.archive.org/web/20210423082804/https://landing.mailerlite.com/webforms/landing/h5b8h7">subscribe to my newsletter here</a>!</p>


    <div id="hyvor-talk-view" class="margin-center width-700-important border-top pt-6 mt-6" style="max-width: 100%;"><iframe src="./Understanding_files/comments.html" id="hyvor-talk-iframe" name="hyvor-talk-iframe" style="width: 1px; min-width: 100%; height: 120px; border: none; user-select: none;" allow="autoplay &#39;self&#39;; fullscreen &#39;self&#39;" allowtranparency="true" tabindex="0" scrolling="no" frameborder="0"></iframe></div>
    <script type="text/javascript">
        var HYVOR_TALK_WEBSITE = 1008; // DO NOT CHANGE THIS
        var HYVOR_TALK_CONFIG = {
            url: false,
            id: false
        };
    </script>
    <script async="" type="text/javascript" src="./Understanding_files/embed"></script>
</div>
        </div>
        <div class="footer">
    <div class="container">
        <span>Copyright Samson Zhang 2021. Made with ❤ in <b>New York</b> and <b>Andover</b>.</span>
    </div>
</div>
        
        <!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="./Understanding_files/js"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-59142353-2');
</script>
        
    

<div id="ba_g_a_bfcjdsin" style="color: initial; font: initial; font-feature-settings: initial; font-kerning: initial; font-optical-sizing: initial; font-palette: initial; font-synthesis: initial; font-variation-settings: initial; forced-color-adjust: initial; text-orientation: initial; text-rendering: initial; -webkit-font-smoothing: initial; -webkit-locale: initial; -webkit-text-orientation: initial; -webkit-writing-mode: initial; writing-mode: initial; zoom: initial; accent-color: initial; place-content: initial; place-items: initial; place-self: initial; alignment-baseline: initial; animation: initial; app-region: initial; appearance: initial; aspect-ratio: initial; backdrop-filter: initial; backface-visibility: initial; background: initial; background-blend-mode: initial; baseline-shift: initial; block-size: initial; border-block: initial; border: initial; border-radius: initial; border-collapse: initial; border-end-end-radius: initial; border-end-start-radius: initial; border-inline: initial; border-start-end-radius: initial; border-start-start-radius: initial; inset: initial; box-shadow: initial; box-sizing: initial; break-after: initial; break-before: initial; break-inside: initial; buffered-rendering: initial; caption-side: initial; caret-color: initial; clear: initial; clip: initial; clip-path: initial; clip-rule: initial; color-interpolation: initial; color-interpolation-filters: initial; color-rendering: initial; color-scheme: initial; columns: initial; column-fill: initial; gap: initial; column-rule: initial; column-span: initial; contain: initial; contain-intrinsic-block-size: initial; contain-intrinsic-size: initial; contain-intrinsic-inline-size: initial; container: initial; content: initial; content-visibility: initial; counter-increment: initial; counter-reset: initial; counter-set: initial; cursor: initial; cx: initial; cy: initial; d: initial; display: initial; dominant-baseline: initial; empty-cells: initial; fill: initial; fill-opacity: initial; fill-rule: initial; filter: initial; flex: initial; flex-flow: initial; float: initial; flood-color: initial; flood-opacity: initial; grid: initial; grid-area: initial; height: initial; hyphenate-character: initial; hyphenate-limit-chars: initial; hyphens: initial; image-orientation: initial; image-rendering: initial; inline-size: initial; inset-block: initial; inset-inline: initial; isolation: initial; letter-spacing: initial; lighting-color: initial; line-break: initial; list-style: initial; margin-block: initial; margin: initial; margin-inline: initial; marker: initial; mask: initial; mask-type: initial; math-depth: initial; math-shift: initial; math-style: initial; max-block-size: initial; max-height: initial; max-inline-size: initial; max-width: initial; min-block-size: initial; min-height: initial; min-inline-size: initial; min-width: initial; mix-blend-mode: initial; object-fit: initial; object-position: initial; object-view-box: initial; offset: initial; opacity: initial; order: initial; origin-trial-test-property: initial; orphans: initial; outline: initial; outline-offset: initial; overflow-anchor: initial; overflow-clip-margin: initial; overflow-wrap: initial; overflow: initial; overscroll-behavior-block: initial; overscroll-behavior-inline: initial; overscroll-behavior: initial; padding-block: initial; padding: initial; padding-inline: initial; page: initial; page-orientation: initial; paint-order: initial; perspective: initial; perspective-origin: initial; pointer-events: initial; position: relative; quotes: initial; r: initial; resize: initial; rotate: initial; ruby-position: initial; rx: initial; ry: initial; scale: initial; scroll-behavior: initial; scroll-margin-block: initial; scroll-margin: initial; scroll-margin-inline: initial; scroll-padding-block: initial; scroll-padding: initial; scroll-padding-inline: initial; scroll-snap-align: initial; scroll-snap-stop: initial; scroll-snap-type: initial; scrollbar-gutter: initial; shape-image-threshold: initial; shape-margin: initial; shape-outside: initial; shape-rendering: initial; size: initial; speak: initial; stop-color: initial; stop-opacity: initial; stroke: initial; stroke-dasharray: initial; stroke-dashoffset: initial; stroke-linecap: initial; stroke-linejoin: initial; stroke-miterlimit: initial; stroke-opacity: initial; stroke-width: initial; tab-size: initial; table-layout: initial; text-align: initial; text-align-last: initial; text-anchor: initial; text-combine-upright: initial; text-decoration: initial; text-decoration-skip-ink: initial; text-emphasis: initial; text-emphasis-position: initial; text-indent: initial; text-overflow: initial; text-shadow: initial; text-size-adjust: initial; text-transform: initial; text-underline-offset: initial; text-underline-position: initial; touch-action: initial; transform: initial; transform-box: initial; transform-origin: initial; transform-style: initial; transition: initial; translate: initial; user-select: initial; vector-effect: initial; vertical-align: initial; visibility: initial; border-spacing: initial; -webkit-box-align: initial; -webkit-box-decoration-break: initial; -webkit-box-direction: initial; -webkit-box-flex: initial; -webkit-box-ordinal-group: initial; -webkit-box-orient: initial; -webkit-box-pack: initial; -webkit-box-reflect: initial; -webkit-highlight: initial; -webkit-line-break: initial; -webkit-line-clamp: initial; -webkit-mask-box-image: initial; -webkit-mask: initial; -webkit-mask-composite: initial; -webkit-print-color-adjust: initial; -webkit-rtl-ordering: initial; -webkit-ruby-position: initial; -webkit-tap-highlight-color: initial; -webkit-text-combine: initial; -webkit-text-decorations-in-effect: initial; -webkit-text-fill-color: initial; -webkit-text-security: initial; -webkit-text-stroke: initial; -webkit-user-drag: initial; -webkit-user-modify: initial; white-space: initial; widows: initial; width: initial; will-change: initial; word-break: initial; word-spacing: initial; x: initial; y: initial; z-index: 2147483647;"><style type="text/css">@font-face{font-family:"Roboto";src:url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-100.woff) format("woff"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-100.woff2) format("woff2"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-100.ttf) format("truetype");font-style:normal;font-weight:100;font-display:swap}@font-face{font-family:"Roboto";src:url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-300.woff) format("woff"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-300.woff2) format("woff2"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-300.ttf) format("truetype");font-style:normal;font-weight:300;font-display:swap}@font-face{font-family:"Roboto";src:url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-400.woff) format("woff"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-400.woff2) format("woff2"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-400.ttf) format("truetype");font-style:normal;font-weight:400;font-display:swap}@font-face{font-family:"Roboto";src:url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-500.woff) format("woff"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-500.woff2) format("woff2"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-500.ttf) format("truetype");font-style:normal;font-weight:500;font-display:swap}@font-face{font-family:"Roboto";src:url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-700.woff) format("woff"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-700.woff2) format("woff2"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-700.ttf) format("truetype");font-style:normal;font-weight:700;font-display:swap}@font-face{font-family:"Roboto";src:url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-900.woff) format("woff"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-900.woff2) format("woff2"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-900.ttf) format("truetype");font-style:normal;font-weight:900;font-display:swap}@font-face{font-family:"Rebond";src:url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-400.woff) format("woff"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-400.woff2) format("woff2"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-400.ttf) format("truetype");font-style:normal;font-weight:400;font-display:swap}@font-face{font-family:"Rebond";src:url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-500.woff) format("woff"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-500.woff2) format("woff2"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-500.ttf) format("truetype");font-style:normal;font-weight:500;font-display:swap}@font-face{font-family:"Rebond";src:url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-600.woff) format("woff"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-600.woff2) format("woff2"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-600.ttf) format("truetype");font-style:normal;font-weight:600;font-display:swap}@font-face{font-family:"Rebond";src:url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-700.woff) format("woff"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-700.woff2) format("woff2"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-700.ttf) format("truetype");font-style:normal;font-weight:700;font-display:swap}</style><style type="text/css">#ba_g_a_bfcjdsin div:empty {
          display: block !important;
        }#__wikibuy__ .__wikibuy.__onTop,body~div:not(#gdx-bubble-host),#piggyWrapper,#honeyContainer,#earny-root{position:absolute !important;z-index:100000 !important}body[data-shop-url="https://www.honeybum.com"] header>.header{z-index:99999}.mm-slideout{z-index:initial}.sorry-for-this__empty-styles{position:relative;z-index:10000}</style><div style="all: initial;"></div></div></body></html>